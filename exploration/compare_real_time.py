{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "805c8748",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "True"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import pandas as pd\n",
    "import requests\n",
    "import json\n",
    "import os\n",
    "import io\n",
    "import py7zr\n",
    "import zipfile\n",
    "import csv\n",
    "#from google.transit import gtfs_realtime_pb2\n",
    "import tempfile\n",
    "from datetime import datetime\n",
    "from pathlib import Path\n",
    "from itertools import islice\n",
    "from collections import defaultdict\n",
    "from dotenv import load_dotenv\n",
    "\n",
    "load_dotenv()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "6b9ebb36",
   "metadata": {},
   "outputs": [],
   "source": [
    "GTFS_REGIONAL_RT_KEY = os.getenv(\"GTFS_REGIONAL_RT_KEY\")  # clé GTFS Regional Realtime\n",
    "GTFS_REGIONAL_STATIC_KEY = os.getenv(\"GTFS_REGIONAL_STATIC_KEY\")  # clé GTFS Regional Static"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "723210dd",
   "metadata": {},
   "outputs": [],
   "source": [
    "#def realtime_now_with_route_short_name(operator: str) -> pd.DataFrame:\n",
    "    # 1) GTFS-RT live (souvent gzip/brut)\n",
    "    #url_rt = f\"https://opendata.samtrafiken.se/gtfs-rt/{operator}/TripUpdates.pb\"\n",
    "    #r_rt = requests.get(url_rt, params={\"key\": GTFS_RT_KEY}, timeout=60)\n",
    "    #r_rt.raise_for_status()\n",
    "\n",
    "    #feed = parse_gtfs_rt_any(r_rt.content)\n",
    "\n",
    "    # 2) Static courant (ZIP)\n",
    "    #url_static = f\"https://opendata.samtrafiken.se/gtfs/{operator}/{operator}.zip\"\n",
    "   # r_static = requests.get(url_static, params={\"key\": GTFS_REGIONAL_STATIC_KEY}, timeout=240)\n",
    "   # r_static.raise_for_status()\n",
    "\n",
    "   ## trip_map = build_trip_to_route_short_name_from_static_zip(r_static.content)\n",
    "\n",
    "    # 3) DataFrame enrichi\n",
    "   # df = feed_tripupdates_to_df(feed, trip_map)\n",
    "   # df[\"source\"] = \"realtime\"\n",
    "   # df[\"day\"] = str(dt_date.today())\n",
    "   # return df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "16ee545c",
   "metadata": {},
   "outputs": [],
   "source": [
    "# IL EST NECESSAIRE DE RECUPERER LES IDS DES FICHIERS STATIC TOUS LES JOURS CAR LES IDS CHANGENT"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "4452867f",
   "metadata": {},
   "outputs": [],
   "source": [
    "# API parameters\n",
    "\n",
    "operator = \"sl\"\n",
    "\n",
    "url_rt = f\"https://opendata.samtrafiken.se/gtfs-rt/{operator}/TripUpdates.pb\"\n",
    "url_static = f\"https://opendata.samtrafiken.se/gtfs/{operator}/{operator}.zip\"\n",
    "\n",
    "params_rt = {\n",
    "    \"date\": \"2025-03-15\", \n",
    "    \"key\": GTFS_REGIONAL_RT_KEY\n",
    "}\n",
    "\n",
    "params_static = {\n",
    "    \"date\": \"2025-03-15\", \n",
    "    \"key\": GTFS_REGIONAL_STATIC_KEY\n",
    "}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "cdbb4200",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Entities: 761\n"
     ]
    }
   ],
   "source": [
    "import requests\n",
    "import gzip\n",
    "from google.transit import gtfs_realtime_pb2\n",
    "\n",
    "\n",
    "request_rt = requests.get(url_rt, params=params_rt, timeout=20)\n",
    "request_rt.raise_for_status()\n",
    "\n",
    "raw = request_rt.content\n",
    "\n",
    "# Décompresse seulement si c'est vraiment du gzip (magic bytes 1f 8b)\n",
    "if raw[:2] == b\"\\x1f\\x8b\":\n",
    "    raw = gzip.decompress(raw)\n",
    "\n",
    "feed_rt = gtfs_realtime_pb2.FeedMessage()\n",
    "feed_rt.ParseFromString(raw)\n",
    "\n",
    "print(\"Entities:\", len(feed_rt.entity))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "c22d2ea9",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<Response [200]>\n",
      "---------\n",
      "51826380 Bytes\n",
      "---------\n",
      "Status: 200\n",
      "Content-Type: application/zip\n",
      "Content-Encoding: identity\n",
      "Début (bytes): b'PK\\x03\\x04\\x14\\x00\\x08\\x08'\n"
     ]
    }
   ],
   "source": [
    "# The request\n",
    "request_static = requests.get(f\"{url_static}\", params=params_static, timeout=20)\n",
    "\n",
    "print(request_static)\n",
    "print(\"---\"*3)\n",
    "print(len(request_static.content), \"Bytes\")\n",
    "print(\"---\"*3)\n",
    "print(\"Status:\", request_static.status_code)\n",
    "print(\"Content-Type:\", request_static.headers.get(\"Content-Type\"))\n",
    "print(\"Content-Encoding:\", request_static.headers.get(\"Content-Encoding\"))\n",
    "print(\"Début (bytes):\", request_static.content[:8])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "48d948cc",
   "metadata": {},
   "outputs": [],
   "source": [
    "rows = []\n",
    "\n",
    "for e in feed_rt.entity:\n",
    "    if not e.HasField(\"trip_update\"):\n",
    "        continue\n",
    "\n",
    "    tu = e.trip_update\n",
    "\n",
    "    tr = tu.trip\n",
    "    \n",
    "    for stu in tu.stop_time_update:\n",
    "        row = {\n",
    "            \"entity_id\": e.id,\n",
    "            \"trip_id\": tr.trip_id,\n",
    "            \"start_date\": tr.start_date,\n",
    "            \"schedule_relationship\": tr.schedule_relationship, #VERIFIER QUE JE RECOIS BIEN \n",
    "            \"vehicle_id\": tu.vehicle.id if tu.HasField(\"vehicle\") else None,\n",
    "\n",
    "            \"stop_sequence\": stu.stop_sequence,\n",
    "            \"stop_id\": stu.stop_id,\n",
    "\n",
    "            \"stop_arrival_delay\": stu.arrival.delay if stu.HasField(\"arrival\") else None,\n",
    "            \"stop_arrival_time\": stu.arrival.time if stu.HasField(\"arrival\") else None,\n",
    "            \"stop_uncertainty\": stu.arrival.uncertainty if stu.HasField(\"arrival\") else None,\n",
    "\n",
    "            \"departure_delay\": stu.departure.delay if stu.HasField(\"departure\") else None,\n",
    "            \"departure_time\": stu.departure.time if stu.HasField(\"departure\") else None,\n",
    "            \"departure_uncertainty\": stu.departure.uncertainty if stu.HasField(\"departure\") else None,\n",
    "\n",
    "            \"timestamp\": tu.timestamp if tu.timestamp else None\n",
    "        }\n",
    "        rows.append(row)\n",
    "\n",
    "df_rt = pd.DataFrame(rows)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "03246f9d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>entity_id</th>\n",
       "      <th>trip_id</th>\n",
       "      <th>start_date</th>\n",
       "      <th>schedule_relationship</th>\n",
       "      <th>vehicle_id</th>\n",
       "      <th>stop_sequence</th>\n",
       "      <th>stop_id</th>\n",
       "      <th>stop_arrival_delay</th>\n",
       "      <th>stop_arrival_time</th>\n",
       "      <th>stop_uncertainty</th>\n",
       "      <th>departure_delay</th>\n",
       "      <th>departure_time</th>\n",
       "      <th>departure_uncertainty</th>\n",
       "      <th>timestamp</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>12172</th>\n",
       "      <td>14010517258968335</td>\n",
       "      <td>14010000670282093</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001003003604</td>\n",
       "      <td>5</td>\n",
       "      <td>9022001075270001</td>\n",
       "      <td>0</td>\n",
       "      <td>1766680588</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1766680588</td>\n",
       "      <td>0</td>\n",
       "      <td>1766680400</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7252</th>\n",
       "      <td>14010517279497281</td>\n",
       "      <td>14010000694587444</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001001004618</td>\n",
       "      <td>17</td>\n",
       "      <td>9022001012279001</td>\n",
       "      <td>-83</td>\n",
       "      <td>1766680691</td>\n",
       "      <td>0</td>\n",
       "      <td>-81</td>\n",
       "      <td>1766680693</td>\n",
       "      <td>0</td>\n",
       "      <td>1766680384</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9975</th>\n",
       "      <td>14010517327166980</td>\n",
       "      <td>14010000673587087</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001003005556</td>\n",
       "      <td>10</td>\n",
       "      <td>9022001013051002</td>\n",
       "      <td>-117</td>\n",
       "      <td>1766680743</td>\n",
       "      <td>0</td>\n",
       "      <td>-117</td>\n",
       "      <td>1766680743</td>\n",
       "      <td>0</td>\n",
       "      <td>1766680381</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>949</th>\n",
       "      <td>14010517320766025</td>\n",
       "      <td>14010000677465470</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001003002084</td>\n",
       "      <td>21</td>\n",
       "      <td>9022001010595002</td>\n",
       "      <td>138</td>\n",
       "      <td>1766680681</td>\n",
       "      <td>0</td>\n",
       "      <td>153</td>\n",
       "      <td>1766680696</td>\n",
       "      <td>0</td>\n",
       "      <td>1766680377</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9598</th>\n",
       "      <td>14010517190305815</td>\n",
       "      <td>14010000677074637</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001003005404</td>\n",
       "      <td>1</td>\n",
       "      <td>9022001040130002</td>\n",
       "      <td>-229</td>\n",
       "      <td>1766679791</td>\n",
       "      <td>0</td>\n",
       "      <td>35</td>\n",
       "      <td>1766680055</td>\n",
       "      <td>0</td>\n",
       "      <td>1766680398</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4662</th>\n",
       "      <td>14010517575850750</td>\n",
       "      <td>14010000697799438</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001001007204</td>\n",
       "      <td>11</td>\n",
       "      <td>9022001010294003</td>\n",
       "      <td>-11</td>\n",
       "      <td>1766680249</td>\n",
       "      <td>0</td>\n",
       "      <td>6</td>\n",
       "      <td>1766680266</td>\n",
       "      <td>0</td>\n",
       "      <td>1766680352</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2971</th>\n",
       "      <td>14010517618186644</td>\n",
       "      <td>14010000710460348</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001001506608</td>\n",
       "      <td>34</td>\n",
       "      <td>9022001015383002</td>\n",
       "      <td>-68</td>\n",
       "      <td>1766681380</td>\n",
       "      <td>0</td>\n",
       "      <td>-68</td>\n",
       "      <td>1766681380</td>\n",
       "      <td>0</td>\n",
       "      <td>1766680294</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13088</th>\n",
       "      <td>14010517190317169</td>\n",
       "      <td>14010000677089968</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001003005433</td>\n",
       "      <td>1</td>\n",
       "      <td>9022001041738001</td>\n",
       "      <td>-293</td>\n",
       "      <td>1766680327</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1766680620</td>\n",
       "      <td>0</td>\n",
       "      <td>1766680327</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>955</th>\n",
       "      <td>14010517508495909</td>\n",
       "      <td>14010000702499516</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001002520001</td>\n",
       "      <td>20</td>\n",
       "      <td>9022001001021003</td>\n",
       "      <td>0</td>\n",
       "      <td>1766680026</td>\n",
       "      <td>0</td>\n",
       "      <td>44</td>\n",
       "      <td>1766680100</td>\n",
       "      <td>0</td>\n",
       "      <td>1766680398</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7148</th>\n",
       "      <td>14010517528595342</td>\n",
       "      <td>14010000707554484</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001004500478</td>\n",
       "      <td>7</td>\n",
       "      <td>9022001050995001</td>\n",
       "      <td>-30</td>\n",
       "      <td>1766680455</td>\n",
       "      <td>0</td>\n",
       "      <td>-30</td>\n",
       "      <td>1766680455</td>\n",
       "      <td>0</td>\n",
       "      <td>1766680343</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8279</th>\n",
       "      <td>14010517569037389</td>\n",
       "      <td>14010000706823782</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001001004588</td>\n",
       "      <td>10</td>\n",
       "      <td>9022001050075001</td>\n",
       "      <td>137</td>\n",
       "      <td>1766680746</td>\n",
       "      <td>0</td>\n",
       "      <td>147</td>\n",
       "      <td>1766680756</td>\n",
       "      <td>0</td>\n",
       "      <td>1766680348</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10340</th>\n",
       "      <td>14010517327857703</td>\n",
       "      <td>14010000673587184</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001003002814</td>\n",
       "      <td>16</td>\n",
       "      <td>9022001013037002</td>\n",
       "      <td>-51</td>\n",
       "      <td>1766682489</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1766682540</td>\n",
       "      <td>0</td>\n",
       "      <td>1766680357</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10030</th>\n",
       "      <td>14010517520532521</td>\n",
       "      <td>14010000706744734</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>None</td>\n",
       "      <td>26</td>\n",
       "      <td>9022001007611002</td>\n",
       "      <td>-55</td>\n",
       "      <td>1766683145</td>\n",
       "      <td>0</td>\n",
       "      <td>-55</td>\n",
       "      <td>1766683145</td>\n",
       "      <td>0</td>\n",
       "      <td>1766680396</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11480</th>\n",
       "      <td>14010517328986621</td>\n",
       "      <td>14010000685625707</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001003005602</td>\n",
       "      <td>23</td>\n",
       "      <td>9022001070048002</td>\n",
       "      <td>64</td>\n",
       "      <td>1766681938</td>\n",
       "      <td>0</td>\n",
       "      <td>79</td>\n",
       "      <td>1766681953</td>\n",
       "      <td>0</td>\n",
       "      <td>1766680398</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12416</th>\n",
       "      <td>14010517241746586</td>\n",
       "      <td>14010000644194398</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001003003507</td>\n",
       "      <td>16</td>\n",
       "      <td>9022001054030002</td>\n",
       "      <td>0</td>\n",
       "      <td>1766682740</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1766682740</td>\n",
       "      <td>0</td>\n",
       "      <td>1766680323</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5855</th>\n",
       "      <td>14010517214100709</td>\n",
       "      <td>14010000694859041</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001004302556</td>\n",
       "      <td>18</td>\n",
       "      <td>9022001005131002</td>\n",
       "      <td>0</td>\n",
       "      <td>1766683260</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1766683260</td>\n",
       "      <td>0</td>\n",
       "      <td>1766680393</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5389</th>\n",
       "      <td>14010517384981927</td>\n",
       "      <td>14010100621518634</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001003003061</td>\n",
       "      <td>18</td>\n",
       "      <td>9022001081397001</td>\n",
       "      <td>-22</td>\n",
       "      <td>1766680646</td>\n",
       "      <td>0</td>\n",
       "      <td>-18</td>\n",
       "      <td>1766680650</td>\n",
       "      <td>0</td>\n",
       "      <td>1766680397</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>691</th>\n",
       "      <td>14010517580452224</td>\n",
       "      <td>14010000709019404</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001004505001</td>\n",
       "      <td>19</td>\n",
       "      <td>9022001060314001</td>\n",
       "      <td>-345</td>\n",
       "      <td>1766680395</td>\n",
       "      <td>0</td>\n",
       "      <td>-285</td>\n",
       "      <td>1766680455</td>\n",
       "      <td>0</td>\n",
       "      <td>1766680393</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3930</th>\n",
       "      <td>14010517580694500</td>\n",
       "      <td>14010000709020289</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001004505127</td>\n",
       "      <td>19</td>\n",
       "      <td>9022001060503001</td>\n",
       "      <td>42</td>\n",
       "      <td>1766680939</td>\n",
       "      <td>0</td>\n",
       "      <td>50</td>\n",
       "      <td>1766680947</td>\n",
       "      <td>0</td>\n",
       "      <td>1766680403</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4991</th>\n",
       "      <td>14010517646552219</td>\n",
       "      <td>14010000710660957</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001004505120</td>\n",
       "      <td>39</td>\n",
       "      <td>9022001064609002</td>\n",
       "      <td>-246</td>\n",
       "      <td>1766682523</td>\n",
       "      <td>0</td>\n",
       "      <td>-246</td>\n",
       "      <td>1766682523</td>\n",
       "      <td>0</td>\n",
       "      <td>1766680403</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               entity_id            trip_id start_date  schedule_relationship  \\\n",
       "12172  14010517258968335  14010000670282093   20251225                      0   \n",
       "7252   14010517279497281  14010000694587444   20251225                      0   \n",
       "9975   14010517327166980  14010000673587087   20251225                      0   \n",
       "949    14010517320766025  14010000677465470   20251225                      0   \n",
       "9598   14010517190305815  14010000677074637   20251225                      0   \n",
       "4662   14010517575850750  14010000697799438   20251225                      0   \n",
       "2971   14010517618186644  14010000710460348   20251225                      0   \n",
       "13088  14010517190317169  14010000677089968   20251225                      0   \n",
       "955    14010517508495909  14010000702499516   20251225                      0   \n",
       "7148   14010517528595342  14010000707554484   20251225                      0   \n",
       "8279   14010517569037389  14010000706823782   20251225                      0   \n",
       "10340  14010517327857703  14010000673587184   20251225                      0   \n",
       "10030  14010517520532521  14010000706744734   20251225                      0   \n",
       "11480  14010517328986621  14010000685625707   20251225                      0   \n",
       "12416  14010517241746586  14010000644194398   20251225                      0   \n",
       "5855   14010517214100709  14010000694859041   20251225                      0   \n",
       "5389   14010517384981927  14010100621518634   20251225                      0   \n",
       "691    14010517580452224  14010000709019404   20251225                      0   \n",
       "3930   14010517580694500  14010000709020289   20251225                      0   \n",
       "4991   14010517646552219  14010000710660957   20251225                      0   \n",
       "\n",
       "             vehicle_id  stop_sequence           stop_id  stop_arrival_delay  \\\n",
       "12172  9031001003003604              5  9022001075270001                   0   \n",
       "7252   9031001001004618             17  9022001012279001                 -83   \n",
       "9975   9031001003005556             10  9022001013051002                -117   \n",
       "949    9031001003002084             21  9022001010595002                 138   \n",
       "9598   9031001003005404              1  9022001040130002                -229   \n",
       "4662   9031001001007204             11  9022001010294003                 -11   \n",
       "2971   9031001001506608             34  9022001015383002                 -68   \n",
       "13088  9031001003005433              1  9022001041738001                -293   \n",
       "955    9031001002520001             20  9022001001021003                   0   \n",
       "7148   9031001004500478              7  9022001050995001                 -30   \n",
       "8279   9031001001004588             10  9022001050075001                 137   \n",
       "10340  9031001003002814             16  9022001013037002                 -51   \n",
       "10030              None             26  9022001007611002                 -55   \n",
       "11480  9031001003005602             23  9022001070048002                  64   \n",
       "12416  9031001003003507             16  9022001054030002                   0   \n",
       "5855   9031001004302556             18  9022001005131002                   0   \n",
       "5389   9031001003003061             18  9022001081397001                 -22   \n",
       "691    9031001004505001             19  9022001060314001                -345   \n",
       "3930   9031001004505127             19  9022001060503001                  42   \n",
       "4991   9031001004505120             39  9022001064609002                -246   \n",
       "\n",
       "       stop_arrival_time  stop_uncertainty  departure_delay  departure_time  \\\n",
       "12172         1766680588                 0                0      1766680588   \n",
       "7252          1766680691                 0              -81      1766680693   \n",
       "9975          1766680743                 0             -117      1766680743   \n",
       "949           1766680681                 0              153      1766680696   \n",
       "9598          1766679791                 0               35      1766680055   \n",
       "4662          1766680249                 0                6      1766680266   \n",
       "2971          1766681380                 0              -68      1766681380   \n",
       "13088         1766680327                 0                0      1766680620   \n",
       "955           1766680026                 0               44      1766680100   \n",
       "7148          1766680455                 0              -30      1766680455   \n",
       "8279          1766680746                 0              147      1766680756   \n",
       "10340         1766682489                 0                0      1766682540   \n",
       "10030         1766683145                 0              -55      1766683145   \n",
       "11480         1766681938                 0               79      1766681953   \n",
       "12416         1766682740                 0                0      1766682740   \n",
       "5855          1766683260                 0                0      1766683260   \n",
       "5389          1766680646                 0              -18      1766680650   \n",
       "691           1766680395                 0             -285      1766680455   \n",
       "3930          1766680939                 0               50      1766680947   \n",
       "4991          1766682523                 0             -246      1766682523   \n",
       "\n",
       "       departure_uncertainty   timestamp  \n",
       "12172                      0  1766680400  \n",
       "7252                       0  1766680384  \n",
       "9975                       0  1766680381  \n",
       "949                        0  1766680377  \n",
       "9598                       0  1766680398  \n",
       "4662                       0  1766680352  \n",
       "2971                       0  1766680294  \n",
       "13088                      0  1766680327  \n",
       "955                        0  1766680398  \n",
       "7148                       0  1766680343  \n",
       "8279                       0  1766680348  \n",
       "10340                      0  1766680357  \n",
       "10030                      0  1766680396  \n",
       "11480                      0  1766680398  \n",
       "12416                      0  1766680323  \n",
       "5855                       0  1766680393  \n",
       "5389                       0  1766680397  \n",
       "691                        0  1766680393  \n",
       "3930                       0  1766680403  \n",
       "4991                       0  1766680403  "
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_rt.sample(20)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3bf997b8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#import io\n",
    "#import zipfile\n",
    "# OUVERTURE DU ZIP POUR LES .TXT\n",
    "#archive_bytes = io.BytesIO(request_static.content)\n",
    "\n",
    "#with zipfile.ZipFile(archive_bytes, \"r\") as z:\n",
    "    #names = z.namelist()\n",
    "\n",
    "#print(\"Total entrées:\", len(names))\n",
    "#print(\"Exemples:\", names[:10])\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e2704918",
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "\n",
    "#with zipfile.ZipFile(archive_bytes, \"r\") as z:\n",
    " #   with z.open(\"trips.txt\") as f:\n",
    "  #      reader = csv.DictReader(io.TextIOWrapper(f, encoding=\"utf-8\"))\n",
    "   #     trips = list(reader)\n",
    "\n",
    "#print(\"Nombre de trips:\", len(trips))\n",
    "#print(\"Exemple:\", trips[0])\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "d2deba7e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>route_id</th>\n",
       "      <th>service_id</th>\n",
       "      <th>trip_id</th>\n",
       "      <th>trip_headsign</th>\n",
       "      <th>direction_id</th>\n",
       "      <th>shape_id</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>9011001000100000</td>\n",
       "      <td>1</td>\n",
       "      <td>14010100704898439</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>1014010000482329256</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>9011001000100000</td>\n",
       "      <td>2</td>\n",
       "      <td>14010100708559249</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>1014010000482329256</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>9011001000100000</td>\n",
       "      <td>3</td>\n",
       "      <td>14010200664345127</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>1014010000482329256</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>9011001000100000</td>\n",
       "      <td>1</td>\n",
       "      <td>14010200669010872</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>1014010000482329256</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>9011001000100000</td>\n",
       "      <td>4</td>\n",
       "      <td>14010100702335572</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>1014010000482329256</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>103375</th>\n",
       "      <td>9011008003100000</td>\n",
       "      <td>18</td>\n",
       "      <td>14010100699024499</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>6014010000348824586</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>103376</th>\n",
       "      <td>9011008003100000</td>\n",
       "      <td>354</td>\n",
       "      <td>14010000705103412</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>6014010000705103172</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>103377</th>\n",
       "      <td>9011008003100000</td>\n",
       "      <td>354</td>\n",
       "      <td>14010000699024239</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>6014010000167945743</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>103378</th>\n",
       "      <td>9011008003100000</td>\n",
       "      <td>354</td>\n",
       "      <td>14010000699024255</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>6014010000191938186</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>103379</th>\n",
       "      <td>9011008003100000</td>\n",
       "      <td>373</td>\n",
       "      <td>14010000705103380</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>6014010000191938406</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>103380 rows × 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                route_id  service_id            trip_id  trip_headsign  \\\n",
       "0       9011001000100000           1  14010100704898439            NaN   \n",
       "1       9011001000100000           2  14010100708559249            NaN   \n",
       "2       9011001000100000           3  14010200664345127            NaN   \n",
       "3       9011001000100000           1  14010200669010872            NaN   \n",
       "4       9011001000100000           4  14010100702335572            NaN   \n",
       "...                  ...         ...                ...            ...   \n",
       "103375  9011008003100000          18  14010100699024499            NaN   \n",
       "103376  9011008003100000         354  14010000705103412            NaN   \n",
       "103377  9011008003100000         354  14010000699024239            NaN   \n",
       "103378  9011008003100000         354  14010000699024255            NaN   \n",
       "103379  9011008003100000         373  14010000705103380            NaN   \n",
       "\n",
       "        direction_id             shape_id  \n",
       "0                  1  1014010000482329256  \n",
       "1                  1  1014010000482329256  \n",
       "2                  1  1014010000482329256  \n",
       "3                  1  1014010000482329256  \n",
       "4                  1  1014010000482329256  \n",
       "...              ...                  ...  \n",
       "103375             0  6014010000348824586  \n",
       "103376             0  6014010000705103172  \n",
       "103377             0  6014010000167945743  \n",
       "103378             0  6014010000191938186  \n",
       "103379             0  6014010000191938406  \n",
       "\n",
       "[103380 rows x 6 columns]"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "archive_bytes_static = io.BytesIO(request_static.content)\n",
    "\n",
    "with zipfile.ZipFile(archive_bytes_static, \"r\") as z:\n",
    "    with z.open(\"trips.txt\") as f:\n",
    "        df_trips = pd.read_csv(f)\n",
    "\n",
    "df_trips\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "390b1e33",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>entity_id</th>\n",
       "      <th>trip_id</th>\n",
       "      <th>start_date</th>\n",
       "      <th>schedule_relationship</th>\n",
       "      <th>vehicle_id</th>\n",
       "      <th>stop_sequence</th>\n",
       "      <th>stop_id</th>\n",
       "      <th>stop_arrival_delay</th>\n",
       "      <th>stop_arrival_time</th>\n",
       "      <th>stop_uncertainty</th>\n",
       "      <th>departure_delay</th>\n",
       "      <th>departure_time</th>\n",
       "      <th>departure_uncertainty</th>\n",
       "      <th>timestamp</th>\n",
       "      <th>route_id</th>\n",
       "      <th>service_id</th>\n",
       "      <th>trip_headsign</th>\n",
       "      <th>direction_id</th>\n",
       "      <th>shape_id</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>14010517605467215</td>\n",
       "      <td>14010000684979940</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001003005316</td>\n",
       "      <td>12</td>\n",
       "      <td>9022001040243002</td>\n",
       "      <td>7992</td>\n",
       "      <td>1766680325</td>\n",
       "      <td>0</td>\n",
       "      <td>7992</td>\n",
       "      <td>1766680325</td>\n",
       "      <td>0</td>\n",
       "      <td>1766680146</td>\n",
       "      <td>9011001044400000</td>\n",
       "      <td>552.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.014010e+18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>14010517605467215</td>\n",
       "      <td>14010000684979940</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001003005316</td>\n",
       "      <td>13</td>\n",
       "      <td>9022001010595002</td>\n",
       "      <td>7892</td>\n",
       "      <td>1766680566</td>\n",
       "      <td>0</td>\n",
       "      <td>7896</td>\n",
       "      <td>1766680570</td>\n",
       "      <td>0</td>\n",
       "      <td>1766680146</td>\n",
       "      <td>9011001044400000</td>\n",
       "      <td>552.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.014010e+18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>14010517605467215</td>\n",
       "      <td>14010000684979940</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001003005316</td>\n",
       "      <td>14</td>\n",
       "      <td>9022001010591002</td>\n",
       "      <td>7915</td>\n",
       "      <td>1766680645</td>\n",
       "      <td>0</td>\n",
       "      <td>7930</td>\n",
       "      <td>1766680660</td>\n",
       "      <td>0</td>\n",
       "      <td>1766680146</td>\n",
       "      <td>9011001044400000</td>\n",
       "      <td>552.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.014010e+18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>14010517605467215</td>\n",
       "      <td>14010000684979940</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001003005316</td>\n",
       "      <td>15</td>\n",
       "      <td>9022001044000019</td>\n",
       "      <td>7811</td>\n",
       "      <td>1766680811</td>\n",
       "      <td>0</td>\n",
       "      <td>7821</td>\n",
       "      <td>1766680821</td>\n",
       "      <td>0</td>\n",
       "      <td>1766680146</td>\n",
       "      <td>9011001044400000</td>\n",
       "      <td>552.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.014010e+18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>14010517645503616</td>\n",
       "      <td>14010000711063390</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031008000500513</td>\n",
       "      <td>19</td>\n",
       "      <td>9022001000907001</td>\n",
       "      <td>247</td>\n",
       "      <td>1766679967</td>\n",
       "      <td>0</td>\n",
       "      <td>317</td>\n",
       "      <td>1766680037</td>\n",
       "      <td>0</td>\n",
       "      <td>1766680358</td>\n",
       "      <td>9011008000900000</td>\n",
       "      <td>18.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>6.014010e+18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13518</th>\n",
       "      <td>14010517636563478</td>\n",
       "      <td>14010000702564700</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001002510001</td>\n",
       "      <td>10</td>\n",
       "      <td>9022001003161002</td>\n",
       "      <td>-25</td>\n",
       "      <td>1766682185</td>\n",
       "      <td>0</td>\n",
       "      <td>7</td>\n",
       "      <td>1766682241</td>\n",
       "      <td>0</td>\n",
       "      <td>1766680403</td>\n",
       "      <td>9011001001000000</td>\n",
       "      <td>39.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3.014010e+18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13519</th>\n",
       "      <td>14010517636563478</td>\n",
       "      <td>14010000702564700</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001002510001</td>\n",
       "      <td>11</td>\n",
       "      <td>9022001001151004</td>\n",
       "      <td>-26</td>\n",
       "      <td>1766682274</td>\n",
       "      <td>0</td>\n",
       "      <td>6</td>\n",
       "      <td>1766682336</td>\n",
       "      <td>0</td>\n",
       "      <td>1766680403</td>\n",
       "      <td>9011001001000000</td>\n",
       "      <td>39.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3.014010e+18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13520</th>\n",
       "      <td>14010517636563478</td>\n",
       "      <td>14010000702564700</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001002510001</td>\n",
       "      <td>12</td>\n",
       "      <td>9022001003131002</td>\n",
       "      <td>-24</td>\n",
       "      <td>1766682378</td>\n",
       "      <td>0</td>\n",
       "      <td>8</td>\n",
       "      <td>1766682434</td>\n",
       "      <td>0</td>\n",
       "      <td>1766680403</td>\n",
       "      <td>9011001001000000</td>\n",
       "      <td>39.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3.014010e+18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13521</th>\n",
       "      <td>14010517636563478</td>\n",
       "      <td>14010000702564700</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001002510001</td>\n",
       "      <td>13</td>\n",
       "      <td>9022001001051006</td>\n",
       "      <td>-29</td>\n",
       "      <td>1766682469</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1766682541</td>\n",
       "      <td>0</td>\n",
       "      <td>1766680403</td>\n",
       "      <td>9011001001000000</td>\n",
       "      <td>39.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3.014010e+18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13522</th>\n",
       "      <td>14010517636563478</td>\n",
       "      <td>14010000702564700</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001002510001</td>\n",
       "      <td>14</td>\n",
       "      <td>9022001003031002</td>\n",
       "      <td>-44</td>\n",
       "      <td>1766682580</td>\n",
       "      <td>0</td>\n",
       "      <td>-44</td>\n",
       "      <td>1766682580</td>\n",
       "      <td>0</td>\n",
       "      <td>1766680403</td>\n",
       "      <td>9011001001000000</td>\n",
       "      <td>39.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3.014010e+18</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>13523 rows × 19 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "               entity_id            trip_id start_date  schedule_relationship  \\\n",
       "0      14010517605467215  14010000684979940   20251225                      0   \n",
       "1      14010517605467215  14010000684979940   20251225                      0   \n",
       "2      14010517605467215  14010000684979940   20251225                      0   \n",
       "3      14010517605467215  14010000684979940   20251225                      0   \n",
       "4      14010517645503616  14010000711063390   20251225                      0   \n",
       "...                  ...                ...        ...                    ...   \n",
       "13518  14010517636563478  14010000702564700   20251225                      0   \n",
       "13519  14010517636563478  14010000702564700   20251225                      0   \n",
       "13520  14010517636563478  14010000702564700   20251225                      0   \n",
       "13521  14010517636563478  14010000702564700   20251225                      0   \n",
       "13522  14010517636563478  14010000702564700   20251225                      0   \n",
       "\n",
       "             vehicle_id  stop_sequence           stop_id  stop_arrival_delay  \\\n",
       "0      9031001003005316             12  9022001040243002                7992   \n",
       "1      9031001003005316             13  9022001010595002                7892   \n",
       "2      9031001003005316             14  9022001010591002                7915   \n",
       "3      9031001003005316             15  9022001044000019                7811   \n",
       "4      9031008000500513             19  9022001000907001                 247   \n",
       "...                 ...            ...               ...                 ...   \n",
       "13518  9031001002510001             10  9022001003161002                 -25   \n",
       "13519  9031001002510001             11  9022001001151004                 -26   \n",
       "13520  9031001002510001             12  9022001003131002                 -24   \n",
       "13521  9031001002510001             13  9022001001051006                 -29   \n",
       "13522  9031001002510001             14  9022001003031002                 -44   \n",
       "\n",
       "       stop_arrival_time  stop_uncertainty  departure_delay  departure_time  \\\n",
       "0             1766680325                 0             7992      1766680325   \n",
       "1             1766680566                 0             7896      1766680570   \n",
       "2             1766680645                 0             7930      1766680660   \n",
       "3             1766680811                 0             7821      1766680821   \n",
       "4             1766679967                 0              317      1766680037   \n",
       "...                  ...               ...              ...             ...   \n",
       "13518         1766682185                 0                7      1766682241   \n",
       "13519         1766682274                 0                6      1766682336   \n",
       "13520         1766682378                 0                8      1766682434   \n",
       "13521         1766682469                 0                1      1766682541   \n",
       "13522         1766682580                 0              -44      1766682580   \n",
       "\n",
       "       departure_uncertainty   timestamp          route_id  service_id  \\\n",
       "0                          0  1766680146  9011001044400000       552.0   \n",
       "1                          0  1766680146  9011001044400000       552.0   \n",
       "2                          0  1766680146  9011001044400000       552.0   \n",
       "3                          0  1766680146  9011001044400000       552.0   \n",
       "4                          0  1766680358  9011008000900000        18.0   \n",
       "...                      ...         ...               ...         ...   \n",
       "13518                      0  1766680403  9011001001000000        39.0   \n",
       "13519                      0  1766680403  9011001001000000        39.0   \n",
       "13520                      0  1766680403  9011001001000000        39.0   \n",
       "13521                      0  1766680403  9011001001000000        39.0   \n",
       "13522                      0  1766680403  9011001001000000        39.0   \n",
       "\n",
       "       trip_headsign  direction_id      shape_id  \n",
       "0                NaN           0.0  1.014010e+18  \n",
       "1                NaN           0.0  1.014010e+18  \n",
       "2                NaN           0.0  1.014010e+18  \n",
       "3                NaN           0.0  1.014010e+18  \n",
       "4                NaN           0.0  6.014010e+18  \n",
       "...              ...           ...           ...  \n",
       "13518            NaN           0.0  3.014010e+18  \n",
       "13519            NaN           0.0  3.014010e+18  \n",
       "13520            NaN           0.0  3.014010e+18  \n",
       "13521            NaN           0.0  3.014010e+18  \n",
       "13522            NaN           0.0  3.014010e+18  \n",
       "\n",
       "[13523 rows x 19 columns]"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_rt[\"trip_id\"] = df_rt[\"trip_id\"].astype(\"string\")\n",
    "df_trips[\"trip_id\"] = df_trips[\"trip_id\"].astype(\"string\")\n",
    "\n",
    "df_merge_on_trip = df_rt.merge(df_trips, on=\"trip_id\", how=\"left\")\n",
    "df_merge_on_trip"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "4b1dfc86",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>route_id</th>\n",
       "      <th>agency_id</th>\n",
       "      <th>route_short_name</th>\n",
       "      <th>route_long_name</th>\n",
       "      <th>route_type</th>\n",
       "      <th>route_desc</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>9011001000100000</td>\n",
       "      <td>14010000000001001</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>700</td>\n",
       "      <td>blåbuss</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>9011001000200000</td>\n",
       "      <td>14010000000001001</td>\n",
       "      <td>2</td>\n",
       "      <td>NaN</td>\n",
       "      <td>700</td>\n",
       "      <td>blåbuss</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>9011001000300000</td>\n",
       "      <td>14010000000001001</td>\n",
       "      <td>3</td>\n",
       "      <td>NaN</td>\n",
       "      <td>700</td>\n",
       "      <td>blåbuss</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>9011001000400000</td>\n",
       "      <td>14010000000001001</td>\n",
       "      <td>4</td>\n",
       "      <td>NaN</td>\n",
       "      <td>700</td>\n",
       "      <td>blåbuss</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>9011001000500000</td>\n",
       "      <td>14010000000001001</td>\n",
       "      <td>5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>700</td>\n",
       "      <td>blåbuss</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>594</th>\n",
       "      <td>9011008002500000</td>\n",
       "      <td>14010000000002071</td>\n",
       "      <td>25</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1000</td>\n",
       "      <td>Waxholmsbolaget</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>595</th>\n",
       "      <td>9011008002800000</td>\n",
       "      <td>14010000000002071</td>\n",
       "      <td>28</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1000</td>\n",
       "      <td>Waxholmsbolaget</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>596</th>\n",
       "      <td>9011008002900000</td>\n",
       "      <td>14010000000002071</td>\n",
       "      <td>29</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1000</td>\n",
       "      <td>Waxholmsbolaget</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>597</th>\n",
       "      <td>9011008003000000</td>\n",
       "      <td>14010000000002071</td>\n",
       "      <td>30</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1000</td>\n",
       "      <td>Waxholmsbolaget</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>598</th>\n",
       "      <td>9011008003100000</td>\n",
       "      <td>14010000000002071</td>\n",
       "      <td>31</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1000</td>\n",
       "      <td>Waxholmsbolaget</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>599 rows × 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "             route_id          agency_id route_short_name route_long_name  \\\n",
       "0    9011001000100000  14010000000001001                1             NaN   \n",
       "1    9011001000200000  14010000000001001                2             NaN   \n",
       "2    9011001000300000  14010000000001001                3             NaN   \n",
       "3    9011001000400000  14010000000001001                4             NaN   \n",
       "4    9011001000500000  14010000000001001                5             NaN   \n",
       "..                ...                ...              ...             ...   \n",
       "594  9011008002500000  14010000000002071               25             NaN   \n",
       "595  9011008002800000  14010000000002071               28             NaN   \n",
       "596  9011008002900000  14010000000002071               29             NaN   \n",
       "597  9011008003000000  14010000000002071               30             NaN   \n",
       "598  9011008003100000  14010000000002071               31             NaN   \n",
       "\n",
       "     route_type       route_desc  \n",
       "0           700          blåbuss  \n",
       "1           700          blåbuss  \n",
       "2           700          blåbuss  \n",
       "3           700          blåbuss  \n",
       "4           700          blåbuss  \n",
       "..          ...              ...  \n",
       "594        1000  Waxholmsbolaget  \n",
       "595        1000  Waxholmsbolaget  \n",
       "596        1000  Waxholmsbolaget  \n",
       "597        1000  Waxholmsbolaget  \n",
       "598        1000  Waxholmsbolaget  \n",
       "\n",
       "[599 rows x 6 columns]"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "archive_bytes = io.BytesIO(request_static.content)\n",
    "\n",
    "with zipfile.ZipFile(archive_bytes, \"r\") as z:\n",
    "    with z.open(\"routes.txt\") as f:\n",
    "        df_routes = pd.read_csv(f)\n",
    "\n",
    "df_routes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "31b8c5c3",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>entity_id</th>\n",
       "      <th>trip_id</th>\n",
       "      <th>start_date</th>\n",
       "      <th>schedule_relationship</th>\n",
       "      <th>vehicle_id</th>\n",
       "      <th>stop_sequence</th>\n",
       "      <th>stop_id</th>\n",
       "      <th>stop_arrival_delay</th>\n",
       "      <th>stop_arrival_time</th>\n",
       "      <th>stop_uncertainty</th>\n",
       "      <th>...</th>\n",
       "      <th>route_id</th>\n",
       "      <th>service_id</th>\n",
       "      <th>trip_headsign</th>\n",
       "      <th>direction_id</th>\n",
       "      <th>shape_id</th>\n",
       "      <th>agency_id</th>\n",
       "      <th>route_short_name</th>\n",
       "      <th>route_long_name</th>\n",
       "      <th>route_type</th>\n",
       "      <th>route_desc</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>14010517605467215</td>\n",
       "      <td>14010000684979940</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001003005316</td>\n",
       "      <td>12</td>\n",
       "      <td>9022001040243002</td>\n",
       "      <td>7992</td>\n",
       "      <td>1766680325</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>9011001044400000</td>\n",
       "      <td>552.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.014010e+18</td>\n",
       "      <td>1.401000e+16</td>\n",
       "      <td>444</td>\n",
       "      <td>NaN</td>\n",
       "      <td>700.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>14010517605467215</td>\n",
       "      <td>14010000684979940</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001003005316</td>\n",
       "      <td>13</td>\n",
       "      <td>9022001010595002</td>\n",
       "      <td>7892</td>\n",
       "      <td>1766680566</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>9011001044400000</td>\n",
       "      <td>552.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.014010e+18</td>\n",
       "      <td>1.401000e+16</td>\n",
       "      <td>444</td>\n",
       "      <td>NaN</td>\n",
       "      <td>700.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>14010517605467215</td>\n",
       "      <td>14010000684979940</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001003005316</td>\n",
       "      <td>14</td>\n",
       "      <td>9022001010591002</td>\n",
       "      <td>7915</td>\n",
       "      <td>1766680645</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>9011001044400000</td>\n",
       "      <td>552.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.014010e+18</td>\n",
       "      <td>1.401000e+16</td>\n",
       "      <td>444</td>\n",
       "      <td>NaN</td>\n",
       "      <td>700.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>14010517605467215</td>\n",
       "      <td>14010000684979940</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001003005316</td>\n",
       "      <td>15</td>\n",
       "      <td>9022001044000019</td>\n",
       "      <td>7811</td>\n",
       "      <td>1766680811</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>9011001044400000</td>\n",
       "      <td>552.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.014010e+18</td>\n",
       "      <td>1.401000e+16</td>\n",
       "      <td>444</td>\n",
       "      <td>NaN</td>\n",
       "      <td>700.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>14010517645503616</td>\n",
       "      <td>14010000711063390</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031008000500513</td>\n",
       "      <td>19</td>\n",
       "      <td>9022001000907001</td>\n",
       "      <td>247</td>\n",
       "      <td>1766679967</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>9011008000900000</td>\n",
       "      <td>18.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>6.014010e+18</td>\n",
       "      <td>1.401000e+16</td>\n",
       "      <td>9</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1000.0</td>\n",
       "      <td>Waxholmsbolaget</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13518</th>\n",
       "      <td>14010517636563478</td>\n",
       "      <td>14010000702564700</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001002510001</td>\n",
       "      <td>10</td>\n",
       "      <td>9022001003161002</td>\n",
       "      <td>-25</td>\n",
       "      <td>1766682185</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>9011001001000000</td>\n",
       "      <td>39.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3.014010e+18</td>\n",
       "      <td>1.401000e+16</td>\n",
       "      <td>10</td>\n",
       "      <td>Blå linjen</td>\n",
       "      <td>401.0</td>\n",
       "      <td>tunnelbanans blå linje</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13519</th>\n",
       "      <td>14010517636563478</td>\n",
       "      <td>14010000702564700</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001002510001</td>\n",
       "      <td>11</td>\n",
       "      <td>9022001001151004</td>\n",
       "      <td>-26</td>\n",
       "      <td>1766682274</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>9011001001000000</td>\n",
       "      <td>39.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3.014010e+18</td>\n",
       "      <td>1.401000e+16</td>\n",
       "      <td>10</td>\n",
       "      <td>Blå linjen</td>\n",
       "      <td>401.0</td>\n",
       "      <td>tunnelbanans blå linje</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13520</th>\n",
       "      <td>14010517636563478</td>\n",
       "      <td>14010000702564700</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001002510001</td>\n",
       "      <td>12</td>\n",
       "      <td>9022001003131002</td>\n",
       "      <td>-24</td>\n",
       "      <td>1766682378</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>9011001001000000</td>\n",
       "      <td>39.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3.014010e+18</td>\n",
       "      <td>1.401000e+16</td>\n",
       "      <td>10</td>\n",
       "      <td>Blå linjen</td>\n",
       "      <td>401.0</td>\n",
       "      <td>tunnelbanans blå linje</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13521</th>\n",
       "      <td>14010517636563478</td>\n",
       "      <td>14010000702564700</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001002510001</td>\n",
       "      <td>13</td>\n",
       "      <td>9022001001051006</td>\n",
       "      <td>-29</td>\n",
       "      <td>1766682469</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>9011001001000000</td>\n",
       "      <td>39.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3.014010e+18</td>\n",
       "      <td>1.401000e+16</td>\n",
       "      <td>10</td>\n",
       "      <td>Blå linjen</td>\n",
       "      <td>401.0</td>\n",
       "      <td>tunnelbanans blå linje</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13522</th>\n",
       "      <td>14010517636563478</td>\n",
       "      <td>14010000702564700</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001002510001</td>\n",
       "      <td>14</td>\n",
       "      <td>9022001003031002</td>\n",
       "      <td>-44</td>\n",
       "      <td>1766682580</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>9011001001000000</td>\n",
       "      <td>39.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3.014010e+18</td>\n",
       "      <td>1.401000e+16</td>\n",
       "      <td>10</td>\n",
       "      <td>Blå linjen</td>\n",
       "      <td>401.0</td>\n",
       "      <td>tunnelbanans blå linje</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>13523 rows × 24 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "               entity_id            trip_id start_date  schedule_relationship  \\\n",
       "0      14010517605467215  14010000684979940   20251225                      0   \n",
       "1      14010517605467215  14010000684979940   20251225                      0   \n",
       "2      14010517605467215  14010000684979940   20251225                      0   \n",
       "3      14010517605467215  14010000684979940   20251225                      0   \n",
       "4      14010517645503616  14010000711063390   20251225                      0   \n",
       "...                  ...                ...        ...                    ...   \n",
       "13518  14010517636563478  14010000702564700   20251225                      0   \n",
       "13519  14010517636563478  14010000702564700   20251225                      0   \n",
       "13520  14010517636563478  14010000702564700   20251225                      0   \n",
       "13521  14010517636563478  14010000702564700   20251225                      0   \n",
       "13522  14010517636563478  14010000702564700   20251225                      0   \n",
       "\n",
       "             vehicle_id  stop_sequence           stop_id  stop_arrival_delay  \\\n",
       "0      9031001003005316             12  9022001040243002                7992   \n",
       "1      9031001003005316             13  9022001010595002                7892   \n",
       "2      9031001003005316             14  9022001010591002                7915   \n",
       "3      9031001003005316             15  9022001044000019                7811   \n",
       "4      9031008000500513             19  9022001000907001                 247   \n",
       "...                 ...            ...               ...                 ...   \n",
       "13518  9031001002510001             10  9022001003161002                 -25   \n",
       "13519  9031001002510001             11  9022001001151004                 -26   \n",
       "13520  9031001002510001             12  9022001003131002                 -24   \n",
       "13521  9031001002510001             13  9022001001051006                 -29   \n",
       "13522  9031001002510001             14  9022001003031002                 -44   \n",
       "\n",
       "       stop_arrival_time  stop_uncertainty  ...          route_id  service_id  \\\n",
       "0             1766680325                 0  ...  9011001044400000       552.0   \n",
       "1             1766680566                 0  ...  9011001044400000       552.0   \n",
       "2             1766680645                 0  ...  9011001044400000       552.0   \n",
       "3             1766680811                 0  ...  9011001044400000       552.0   \n",
       "4             1766679967                 0  ...  9011008000900000        18.0   \n",
       "...                  ...               ...  ...               ...         ...   \n",
       "13518         1766682185                 0  ...  9011001001000000        39.0   \n",
       "13519         1766682274                 0  ...  9011001001000000        39.0   \n",
       "13520         1766682378                 0  ...  9011001001000000        39.0   \n",
       "13521         1766682469                 0  ...  9011001001000000        39.0   \n",
       "13522         1766682580                 0  ...  9011001001000000        39.0   \n",
       "\n",
       "       trip_headsign  direction_id      shape_id     agency_id  \\\n",
       "0                NaN           0.0  1.014010e+18  1.401000e+16   \n",
       "1                NaN           0.0  1.014010e+18  1.401000e+16   \n",
       "2                NaN           0.0  1.014010e+18  1.401000e+16   \n",
       "3                NaN           0.0  1.014010e+18  1.401000e+16   \n",
       "4                NaN           0.0  6.014010e+18  1.401000e+16   \n",
       "...              ...           ...           ...           ...   \n",
       "13518            NaN           0.0  3.014010e+18  1.401000e+16   \n",
       "13519            NaN           0.0  3.014010e+18  1.401000e+16   \n",
       "13520            NaN           0.0  3.014010e+18  1.401000e+16   \n",
       "13521            NaN           0.0  3.014010e+18  1.401000e+16   \n",
       "13522            NaN           0.0  3.014010e+18  1.401000e+16   \n",
       "\n",
       "       route_short_name  route_long_name  route_type              route_desc  \n",
       "0                   444              NaN       700.0                     NaN  \n",
       "1                   444              NaN       700.0                     NaN  \n",
       "2                   444              NaN       700.0                     NaN  \n",
       "3                   444              NaN       700.0                     NaN  \n",
       "4                     9              NaN      1000.0         Waxholmsbolaget  \n",
       "...                 ...              ...         ...                     ...  \n",
       "13518                10       Blå linjen       401.0  tunnelbanans blå linje  \n",
       "13519                10       Blå linjen       401.0  tunnelbanans blå linje  \n",
       "13520                10       Blå linjen       401.0  tunnelbanans blå linje  \n",
       "13521                10       Blå linjen       401.0  tunnelbanans blå linje  \n",
       "13522                10       Blå linjen       401.0  tunnelbanans blå linje  \n",
       "\n",
       "[13523 rows x 24 columns]"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_merge_on_route = df_merge_on_trip.merge(df_routes, on=\"route_id\", how=\"left\")\n",
    "df_merge_on_route"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "1226950b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>entity_id</th>\n",
       "      <th>trip_id</th>\n",
       "      <th>start_date</th>\n",
       "      <th>schedule_relationship</th>\n",
       "      <th>vehicle_id</th>\n",
       "      <th>stop_sequence</th>\n",
       "      <th>stop_id</th>\n",
       "      <th>stop_arrival_delay</th>\n",
       "      <th>stop_arrival_time</th>\n",
       "      <th>stop_uncertainty</th>\n",
       "      <th>...</th>\n",
       "      <th>timestamp</th>\n",
       "      <th>route_id</th>\n",
       "      <th>service_id</th>\n",
       "      <th>trip_headsign</th>\n",
       "      <th>direction_id</th>\n",
       "      <th>shape_id</th>\n",
       "      <th>agency_id</th>\n",
       "      <th>route_long_name</th>\n",
       "      <th>route_type</th>\n",
       "      <th>route_desc</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>route_short_name</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>329</td>\n",
       "      <td>329</td>\n",
       "      <td>329</td>\n",
       "      <td>329</td>\n",
       "      <td>329</td>\n",
       "      <td>329</td>\n",
       "      <td>329</td>\n",
       "      <td>329</td>\n",
       "      <td>329</td>\n",
       "      <td>329</td>\n",
       "      <td>...</td>\n",
       "      <td>329</td>\n",
       "      <td>329</td>\n",
       "      <td>329</td>\n",
       "      <td>0</td>\n",
       "      <td>329</td>\n",
       "      <td>329</td>\n",
       "      <td>329</td>\n",
       "      <td>329</td>\n",
       "      <td>329</td>\n",
       "      <td>329</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>254</td>\n",
       "      <td>254</td>\n",
       "      <td>254</td>\n",
       "      <td>254</td>\n",
       "      <td>254</td>\n",
       "      <td>254</td>\n",
       "      <td>254</td>\n",
       "      <td>254</td>\n",
       "      <td>254</td>\n",
       "      <td>254</td>\n",
       "      <td>...</td>\n",
       "      <td>254</td>\n",
       "      <td>254</td>\n",
       "      <td>254</td>\n",
       "      <td>0</td>\n",
       "      <td>254</td>\n",
       "      <td>254</td>\n",
       "      <td>254</td>\n",
       "      <td>212</td>\n",
       "      <td>254</td>\n",
       "      <td>254</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>218</td>\n",
       "      <td>218</td>\n",
       "      <td>218</td>\n",
       "      <td>218</td>\n",
       "      <td>218</td>\n",
       "      <td>218</td>\n",
       "      <td>218</td>\n",
       "      <td>218</td>\n",
       "      <td>218</td>\n",
       "      <td>218</td>\n",
       "      <td>...</td>\n",
       "      <td>218</td>\n",
       "      <td>218</td>\n",
       "      <td>218</td>\n",
       "      <td>0</td>\n",
       "      <td>218</td>\n",
       "      <td>218</td>\n",
       "      <td>218</td>\n",
       "      <td>0</td>\n",
       "      <td>218</td>\n",
       "      <td>218</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>626</th>\n",
       "      <td>214</td>\n",
       "      <td>214</td>\n",
       "      <td>214</td>\n",
       "      <td>214</td>\n",
       "      <td>214</td>\n",
       "      <td>214</td>\n",
       "      <td>214</td>\n",
       "      <td>214</td>\n",
       "      <td>214</td>\n",
       "      <td>214</td>\n",
       "      <td>...</td>\n",
       "      <td>214</td>\n",
       "      <td>214</td>\n",
       "      <td>214</td>\n",
       "      <td>0</td>\n",
       "      <td>214</td>\n",
       "      <td>214</td>\n",
       "      <td>214</td>\n",
       "      <td>0</td>\n",
       "      <td>214</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>176</th>\n",
       "      <td>207</td>\n",
       "      <td>207</td>\n",
       "      <td>207</td>\n",
       "      <td>207</td>\n",
       "      <td>207</td>\n",
       "      <td>207</td>\n",
       "      <td>207</td>\n",
       "      <td>207</td>\n",
       "      <td>207</td>\n",
       "      <td>207</td>\n",
       "      <td>...</td>\n",
       "      <td>207</td>\n",
       "      <td>207</td>\n",
       "      <td>207</td>\n",
       "      <td>0</td>\n",
       "      <td>207</td>\n",
       "      <td>207</td>\n",
       "      <td>207</td>\n",
       "      <td>0</td>\n",
       "      <td>207</td>\n",
       "      <td>207</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>84</th>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>...</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>756</th>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>...</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>546H</th>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>...</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>89</th>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>...</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>780X</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>274 rows × 23 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                  entity_id  trip_id  start_date  schedule_relationship  \\\n",
       "route_short_name                                                          \n",
       "19                      329      329         329                    329   \n",
       "13                      254      254         254                    254   \n",
       "4                       218      218         218                    218   \n",
       "626                     214      214         214                    214   \n",
       "176                     207      207         207                    207   \n",
       "...                     ...      ...         ...                    ...   \n",
       "84                        3        3           3                      3   \n",
       "756                       3        3           3                      3   \n",
       "546H                      2        2           2                      2   \n",
       "89                        2        2           2                      2   \n",
       "780X                      1        1           1                      1   \n",
       "\n",
       "                  vehicle_id  stop_sequence  stop_id  stop_arrival_delay  \\\n",
       "route_short_name                                                           \n",
       "19                       329            329      329                 329   \n",
       "13                       254            254      254                 254   \n",
       "4                        218            218      218                 218   \n",
       "626                      214            214      214                 214   \n",
       "176                      207            207      207                 207   \n",
       "...                      ...            ...      ...                 ...   \n",
       "84                         3              3        3                   3   \n",
       "756                        3              3        3                   3   \n",
       "546H                       2              2        2                   2   \n",
       "89                         2              2        2                   2   \n",
       "780X                       1              1        1                   1   \n",
       "\n",
       "                  stop_arrival_time  stop_uncertainty  ...  timestamp  \\\n",
       "route_short_name                                       ...              \n",
       "19                              329               329  ...        329   \n",
       "13                              254               254  ...        254   \n",
       "4                               218               218  ...        218   \n",
       "626                             214               214  ...        214   \n",
       "176                             207               207  ...        207   \n",
       "...                             ...               ...  ...        ...   \n",
       "84                                3                 3  ...          3   \n",
       "756                               3                 3  ...          3   \n",
       "546H                              2                 2  ...          2   \n",
       "89                                2                 2  ...          2   \n",
       "780X                              1                 1  ...          1   \n",
       "\n",
       "                  route_id  service_id  trip_headsign  direction_id  shape_id  \\\n",
       "route_short_name                                                                \n",
       "19                     329         329              0           329       329   \n",
       "13                     254         254              0           254       254   \n",
       "4                      218         218              0           218       218   \n",
       "626                    214         214              0           214       214   \n",
       "176                    207         207              0           207       207   \n",
       "...                    ...         ...            ...           ...       ...   \n",
       "84                       3           3              0             3         3   \n",
       "756                      3           3              0             3         3   \n",
       "546H                     2           2              0             2         2   \n",
       "89                       2           2              0             2         2   \n",
       "780X                     1           1              0             1         1   \n",
       "\n",
       "                  agency_id  route_long_name  route_type  route_desc  \n",
       "route_short_name                                                      \n",
       "19                      329              329         329         329  \n",
       "13                      254              212         254         254  \n",
       "4                       218                0         218         218  \n",
       "626                     214                0         214           0  \n",
       "176                     207                0         207         207  \n",
       "...                     ...              ...         ...         ...  \n",
       "84                        3                0           3           3  \n",
       "756                       3                0           3           0  \n",
       "546H                      2                0           2           0  \n",
       "89                        2                0           2           2  \n",
       "780X                      1                0           1           0  \n",
       "\n",
       "[274 rows x 23 columns]"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_merge_on_route.groupby(\"route_short_name\").count().sort_values(by=\"entity_id\", ascending=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "541f3677",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>entity_id</th>\n",
       "      <th>trip_id</th>\n",
       "      <th>start_date</th>\n",
       "      <th>schedule_relationship</th>\n",
       "      <th>vehicle_id</th>\n",
       "      <th>stop_sequence</th>\n",
       "      <th>stop_id</th>\n",
       "      <th>stop_arrival_delay</th>\n",
       "      <th>stop_arrival_time</th>\n",
       "      <th>stop_uncertainty</th>\n",
       "      <th>...</th>\n",
       "      <th>route_id</th>\n",
       "      <th>service_id</th>\n",
       "      <th>trip_headsign</th>\n",
       "      <th>direction_id</th>\n",
       "      <th>shape_id</th>\n",
       "      <th>agency_id</th>\n",
       "      <th>route_short_name</th>\n",
       "      <th>route_long_name</th>\n",
       "      <th>route_type</th>\n",
       "      <th>route_desc</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>14010517605467215</td>\n",
       "      <td>14010000684979940</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001003005316</td>\n",
       "      <td>12</td>\n",
       "      <td>9022001040243002</td>\n",
       "      <td>7992</td>\n",
       "      <td>1766680325</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>9011001044400000</td>\n",
       "      <td>552.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.014010e+18</td>\n",
       "      <td>1.401000e+16</td>\n",
       "      <td>444</td>\n",
       "      <td>NaN</td>\n",
       "      <td>700.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>14010517605467215</td>\n",
       "      <td>14010000684979940</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001003005316</td>\n",
       "      <td>13</td>\n",
       "      <td>9022001010595002</td>\n",
       "      <td>7892</td>\n",
       "      <td>1766680566</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>9011001044400000</td>\n",
       "      <td>552.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.014010e+18</td>\n",
       "      <td>1.401000e+16</td>\n",
       "      <td>444</td>\n",
       "      <td>NaN</td>\n",
       "      <td>700.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>14010517605467215</td>\n",
       "      <td>14010000684979940</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001003005316</td>\n",
       "      <td>14</td>\n",
       "      <td>9022001010591002</td>\n",
       "      <td>7915</td>\n",
       "      <td>1766680645</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>9011001044400000</td>\n",
       "      <td>552.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.014010e+18</td>\n",
       "      <td>1.401000e+16</td>\n",
       "      <td>444</td>\n",
       "      <td>NaN</td>\n",
       "      <td>700.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>14010517605467215</td>\n",
       "      <td>14010000684979940</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001003005316</td>\n",
       "      <td>15</td>\n",
       "      <td>9022001044000019</td>\n",
       "      <td>7811</td>\n",
       "      <td>1766680811</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>9011001044400000</td>\n",
       "      <td>552.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.014010e+18</td>\n",
       "      <td>1.401000e+16</td>\n",
       "      <td>444</td>\n",
       "      <td>NaN</td>\n",
       "      <td>700.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>41</th>\n",
       "      <td>14010517558156042</td>\n",
       "      <td>14010000708187798</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001003003060</td>\n",
       "      <td>61</td>\n",
       "      <td>9022001075505001</td>\n",
       "      <td>-16</td>\n",
       "      <td>1766679740</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>9011001078300000</td>\n",
       "      <td>50.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.014010e+18</td>\n",
       "      <td>1.401000e+16</td>\n",
       "      <td>783</td>\n",
       "      <td>NaN</td>\n",
       "      <td>700.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13480</th>\n",
       "      <td>14010517578035273</td>\n",
       "      <td>14010100702300966</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001001004046</td>\n",
       "      <td>11</td>\n",
       "      <td>9022001020051002</td>\n",
       "      <td>6</td>\n",
       "      <td>1766681492</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>9011001020100000</td>\n",
       "      <td>272.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.014010e+18</td>\n",
       "      <td>1.401000e+16</td>\n",
       "      <td>201</td>\n",
       "      <td>NaN</td>\n",
       "      <td>700.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13481</th>\n",
       "      <td>14010517578035273</td>\n",
       "      <td>14010100702300966</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001001004046</td>\n",
       "      <td>12</td>\n",
       "      <td>9022001020041002</td>\n",
       "      <td>-4</td>\n",
       "      <td>1766681576</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>9011001020100000</td>\n",
       "      <td>272.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.014010e+18</td>\n",
       "      <td>1.401000e+16</td>\n",
       "      <td>201</td>\n",
       "      <td>NaN</td>\n",
       "      <td>700.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13482</th>\n",
       "      <td>14010517578035273</td>\n",
       "      <td>14010100702300966</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001001004046</td>\n",
       "      <td>13</td>\n",
       "      <td>9022001020031002</td>\n",
       "      <td>14</td>\n",
       "      <td>1766681630</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>9011001020100000</td>\n",
       "      <td>272.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.014010e+18</td>\n",
       "      <td>1.401000e+16</td>\n",
       "      <td>201</td>\n",
       "      <td>NaN</td>\n",
       "      <td>700.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13483</th>\n",
       "      <td>14010517578035273</td>\n",
       "      <td>14010100702300966</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001001004046</td>\n",
       "      <td>14</td>\n",
       "      <td>9022001020021002</td>\n",
       "      <td>4</td>\n",
       "      <td>1766681690</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>9011001020100000</td>\n",
       "      <td>272.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.014010e+18</td>\n",
       "      <td>1.401000e+16</td>\n",
       "      <td>201</td>\n",
       "      <td>NaN</td>\n",
       "      <td>700.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13484</th>\n",
       "      <td>14010517578035273</td>\n",
       "      <td>14010100702300966</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001001004046</td>\n",
       "      <td>15</td>\n",
       "      <td>9022001010032014</td>\n",
       "      <td>-163</td>\n",
       "      <td>1766681837</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>9011001020100000</td>\n",
       "      <td>272.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.014010e+18</td>\n",
       "      <td>1.401000e+16</td>\n",
       "      <td>201</td>\n",
       "      <td>NaN</td>\n",
       "      <td>700.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>11289 rows × 24 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "               entity_id            trip_id start_date  schedule_relationship  \\\n",
       "0      14010517605467215  14010000684979940   20251225                      0   \n",
       "1      14010517605467215  14010000684979940   20251225                      0   \n",
       "2      14010517605467215  14010000684979940   20251225                      0   \n",
       "3      14010517605467215  14010000684979940   20251225                      0   \n",
       "41     14010517558156042  14010000708187798   20251225                      0   \n",
       "...                  ...                ...        ...                    ...   \n",
       "13480  14010517578035273  14010100702300966   20251225                      0   \n",
       "13481  14010517578035273  14010100702300966   20251225                      0   \n",
       "13482  14010517578035273  14010100702300966   20251225                      0   \n",
       "13483  14010517578035273  14010100702300966   20251225                      0   \n",
       "13484  14010517578035273  14010100702300966   20251225                      0   \n",
       "\n",
       "             vehicle_id  stop_sequence           stop_id  stop_arrival_delay  \\\n",
       "0      9031001003005316             12  9022001040243002                7992   \n",
       "1      9031001003005316             13  9022001010595002                7892   \n",
       "2      9031001003005316             14  9022001010591002                7915   \n",
       "3      9031001003005316             15  9022001044000019                7811   \n",
       "41     9031001003003060             61  9022001075505001                 -16   \n",
       "...                 ...            ...               ...                 ...   \n",
       "13480  9031001001004046             11  9022001020051002                   6   \n",
       "13481  9031001001004046             12  9022001020041002                  -4   \n",
       "13482  9031001001004046             13  9022001020031002                  14   \n",
       "13483  9031001001004046             14  9022001020021002                   4   \n",
       "13484  9031001001004046             15  9022001010032014                -163   \n",
       "\n",
       "       stop_arrival_time  stop_uncertainty  ...          route_id  service_id  \\\n",
       "0             1766680325                 0  ...  9011001044400000       552.0   \n",
       "1             1766680566                 0  ...  9011001044400000       552.0   \n",
       "2             1766680645                 0  ...  9011001044400000       552.0   \n",
       "3             1766680811                 0  ...  9011001044400000       552.0   \n",
       "41            1766679740                 0  ...  9011001078300000        50.0   \n",
       "...                  ...               ...  ...               ...         ...   \n",
       "13480         1766681492                 0  ...  9011001020100000       272.0   \n",
       "13481         1766681576                 0  ...  9011001020100000       272.0   \n",
       "13482         1766681630                 0  ...  9011001020100000       272.0   \n",
       "13483         1766681690                 0  ...  9011001020100000       272.0   \n",
       "13484         1766681837                 0  ...  9011001020100000       272.0   \n",
       "\n",
       "       trip_headsign  direction_id      shape_id     agency_id  \\\n",
       "0                NaN           0.0  1.014010e+18  1.401000e+16   \n",
       "1                NaN           0.0  1.014010e+18  1.401000e+16   \n",
       "2                NaN           0.0  1.014010e+18  1.401000e+16   \n",
       "3                NaN           0.0  1.014010e+18  1.401000e+16   \n",
       "41               NaN           1.0  1.014010e+18  1.401000e+16   \n",
       "...              ...           ...           ...           ...   \n",
       "13480            NaN           0.0  1.014010e+18  1.401000e+16   \n",
       "13481            NaN           0.0  1.014010e+18  1.401000e+16   \n",
       "13482            NaN           0.0  1.014010e+18  1.401000e+16   \n",
       "13483            NaN           0.0  1.014010e+18  1.401000e+16   \n",
       "13484            NaN           0.0  1.014010e+18  1.401000e+16   \n",
       "\n",
       "       route_short_name  route_long_name  route_type  route_desc  \n",
       "0                   444              NaN       700.0         NaN  \n",
       "1                   444              NaN       700.0         NaN  \n",
       "2                   444              NaN       700.0         NaN  \n",
       "3                   444              NaN       700.0         NaN  \n",
       "41                  783              NaN       700.0         NaN  \n",
       "...                 ...              ...         ...         ...  \n",
       "13480               201              NaN       700.0         NaN  \n",
       "13481               201              NaN       700.0         NaN  \n",
       "13482               201              NaN       700.0         NaN  \n",
       "13483               201              NaN       700.0         NaN  \n",
       "13484               201              NaN       700.0         NaN  \n",
       "\n",
       "[11289 rows x 24 columns]"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_bus = df_merge_on_route[df_merge_on_route[\"route_type\"] == 700]\n",
    "df_bus"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "ef04e253",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>shape_id</th>\n",
       "      <th>shape_pt_lat</th>\n",
       "      <th>shape_pt_lon</th>\n",
       "      <th>shape_pt_sequence</th>\n",
       "      <th>shape_dist_traveled</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1014010000482329256</td>\n",
       "      <td>59.341873</td>\n",
       "      <td>18.118316</td>\n",
       "      <td>1</td>\n",
       "      <td>0.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1014010000482329256</td>\n",
       "      <td>59.341853</td>\n",
       "      <td>18.118402</td>\n",
       "      <td>2</td>\n",
       "      <td>0.01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1014010000482329256</td>\n",
       "      <td>59.341754</td>\n",
       "      <td>18.118334</td>\n",
       "      <td>3</td>\n",
       "      <td>12.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1014010000482329256</td>\n",
       "      <td>59.341259</td>\n",
       "      <td>18.118047</td>\n",
       "      <td>4</td>\n",
       "      <td>69.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1014010000482329256</td>\n",
       "      <td>59.340929</td>\n",
       "      <td>18.116765</td>\n",
       "      <td>5</td>\n",
       "      <td>151.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>1014010000482329256</td>\n",
       "      <td>59.340944</td>\n",
       "      <td>18.116478</td>\n",
       "      <td>6</td>\n",
       "      <td>167.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>1014010000482329256</td>\n",
       "      <td>59.340571</td>\n",
       "      <td>18.115033</td>\n",
       "      <td>7</td>\n",
       "      <td>259.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>1014010000482329256</td>\n",
       "      <td>59.340453</td>\n",
       "      <td>18.114870</td>\n",
       "      <td>8</td>\n",
       "      <td>276.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>1014010000482329256</td>\n",
       "      <td>59.340353</td>\n",
       "      <td>18.114259</td>\n",
       "      <td>9</td>\n",
       "      <td>312.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>1014010000482329256</td>\n",
       "      <td>59.341099</td>\n",
       "      <td>18.113851</td>\n",
       "      <td>10</td>\n",
       "      <td>397.99</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>1014010000482329256</td>\n",
       "      <td>59.341138</td>\n",
       "      <td>18.113897</td>\n",
       "      <td>11</td>\n",
       "      <td>398.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>1014010000482329256</td>\n",
       "      <td>59.341129</td>\n",
       "      <td>18.113839</td>\n",
       "      <td>12</td>\n",
       "      <td>398.01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>1014010000482329256</td>\n",
       "      <td>59.341759</td>\n",
       "      <td>18.113509</td>\n",
       "      <td>13</td>\n",
       "      <td>471.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>1014010000482329256</td>\n",
       "      <td>59.341969</td>\n",
       "      <td>18.113419</td>\n",
       "      <td>14</td>\n",
       "      <td>495.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>1014010000482329256</td>\n",
       "      <td>59.342069</td>\n",
       "      <td>18.113399</td>\n",
       "      <td>15</td>\n",
       "      <td>506.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>1014010000482329256</td>\n",
       "      <td>59.342149</td>\n",
       "      <td>18.113379</td>\n",
       "      <td>16</td>\n",
       "      <td>515.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>1014010000482329256</td>\n",
       "      <td>59.342269</td>\n",
       "      <td>18.113359</td>\n",
       "      <td>17</td>\n",
       "      <td>528.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>1014010000482329256</td>\n",
       "      <td>59.342249</td>\n",
       "      <td>18.113169</td>\n",
       "      <td>18</td>\n",
       "      <td>539.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>1014010000482329256</td>\n",
       "      <td>59.342229</td>\n",
       "      <td>18.112999</td>\n",
       "      <td>19</td>\n",
       "      <td>549.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>1014010000482329256</td>\n",
       "      <td>59.342199</td>\n",
       "      <td>18.112679</td>\n",
       "      <td>20</td>\n",
       "      <td>567.01</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               shape_id  shape_pt_lat  shape_pt_lon  shape_pt_sequence  \\\n",
       "0   1014010000482329256     59.341873     18.118316                  1   \n",
       "1   1014010000482329256     59.341853     18.118402                  2   \n",
       "2   1014010000482329256     59.341754     18.118334                  3   \n",
       "3   1014010000482329256     59.341259     18.118047                  4   \n",
       "4   1014010000482329256     59.340929     18.116765                  5   \n",
       "5   1014010000482329256     59.340944     18.116478                  6   \n",
       "6   1014010000482329256     59.340571     18.115033                  7   \n",
       "7   1014010000482329256     59.340453     18.114870                  8   \n",
       "8   1014010000482329256     59.340353     18.114259                  9   \n",
       "9   1014010000482329256     59.341099     18.113851                 10   \n",
       "10  1014010000482329256     59.341138     18.113897                 11   \n",
       "11  1014010000482329256     59.341129     18.113839                 12   \n",
       "12  1014010000482329256     59.341759     18.113509                 13   \n",
       "13  1014010000482329256     59.341969     18.113419                 14   \n",
       "14  1014010000482329256     59.342069     18.113399                 15   \n",
       "15  1014010000482329256     59.342149     18.113379                 16   \n",
       "16  1014010000482329256     59.342269     18.113359                 17   \n",
       "17  1014010000482329256     59.342249     18.113169                 18   \n",
       "18  1014010000482329256     59.342229     18.112999                 19   \n",
       "19  1014010000482329256     59.342199     18.112679                 20   \n",
       "\n",
       "    shape_dist_traveled  \n",
       "0                  0.00  \n",
       "1                  0.01  \n",
       "2                 12.00  \n",
       "3                 69.00  \n",
       "4                151.00  \n",
       "5                167.00  \n",
       "6                259.00  \n",
       "7                276.00  \n",
       "8                312.00  \n",
       "9                397.99  \n",
       "10               398.00  \n",
       "11               398.01  \n",
       "12               471.00  \n",
       "13               495.00  \n",
       "14               506.00  \n",
       "15               515.00  \n",
       "16               528.00  \n",
       "17               539.00  \n",
       "18               549.00  \n",
       "19               567.01  "
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "archive_bytes = io.BytesIO(request_static.content)\n",
    "\n",
    "with zipfile.ZipFile(archive_bytes, \"r\") as z:\n",
    "    with z.open(\"shapes.txt\") as f:\n",
    "        df_shapes = pd.read_csv(f)\n",
    "\n",
    "df_shapes.head(20)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "6fd4f516",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>stop_id</th>\n",
       "      <th>stop_name</th>\n",
       "      <th>stop_lat</th>\n",
       "      <th>stop_lon</th>\n",
       "      <th>location_type</th>\n",
       "      <th>parent_station</th>\n",
       "      <th>platform_code</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>9021001000101000</td>\n",
       "      <td>Stavsnäs</td>\n",
       "      <td>59.286405</td>\n",
       "      <td>18.704700</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>9021001000102000</td>\n",
       "      <td>Styrsvik</td>\n",
       "      <td>59.280184</td>\n",
       "      <td>18.731426</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>9021001000103000</td>\n",
       "      <td>Nämdöböte</td>\n",
       "      <td>59.208731</td>\n",
       "      <td>18.740060</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>9021001000104000</td>\n",
       "      <td>Aspö</td>\n",
       "      <td>59.215843</td>\n",
       "      <td>18.753410</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>9021001000105000</td>\n",
       "      <td>Idöborg</td>\n",
       "      <td>59.204309</td>\n",
       "      <td>18.757769</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>9021001000106000</td>\n",
       "      <td>Östanvik</td>\n",
       "      <td>59.197456</td>\n",
       "      <td>18.739825</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>9021001000107000</td>\n",
       "      <td>Kalkberget</td>\n",
       "      <td>59.191628</td>\n",
       "      <td>18.719581</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>9021001000108000</td>\n",
       "      <td>Västanvik</td>\n",
       "      <td>59.187559</td>\n",
       "      <td>18.706893</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>9021001000109000</td>\n",
       "      <td>Solvik</td>\n",
       "      <td>59.184758</td>\n",
       "      <td>18.700458</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>9021001000110000</td>\n",
       "      <td>Orrön</td>\n",
       "      <td>59.180510</td>\n",
       "      <td>18.700629</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>9021001000111000</td>\n",
       "      <td>Sand</td>\n",
       "      <td>59.182354</td>\n",
       "      <td>18.692684</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>9021001000112000</td>\n",
       "      <td>Bunkvik</td>\n",
       "      <td>59.177537</td>\n",
       "      <td>18.669835</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>9021001000113000</td>\n",
       "      <td>Ängsholmen</td>\n",
       "      <td>59.172723</td>\n",
       "      <td>18.655993</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>9021001000114000</td>\n",
       "      <td>Uvö</td>\n",
       "      <td>59.175039</td>\n",
       "      <td>18.648745</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>9021001000115000</td>\n",
       "      <td>Sunnansund</td>\n",
       "      <td>59.171029</td>\n",
       "      <td>18.639195</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>9021001000116000</td>\n",
       "      <td>Mörtö</td>\n",
       "      <td>59.162453</td>\n",
       "      <td>18.628936</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>9021001000117000</td>\n",
       "      <td>Mörtö södra</td>\n",
       "      <td>59.152702</td>\n",
       "      <td>18.616282</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>9021001000118000</td>\n",
       "      <td>Gatan</td>\n",
       "      <td>59.294298</td>\n",
       "      <td>18.756698</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>9021001000119000</td>\n",
       "      <td>Långvik</td>\n",
       "      <td>59.296235</td>\n",
       "      <td>18.771798</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>9021001000120000</td>\n",
       "      <td>Västra Skarprunmarn</td>\n",
       "      <td>59.305445</td>\n",
       "      <td>18.814167</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "             stop_id            stop_name   stop_lat   stop_lon  \\\n",
       "0   9021001000101000             Stavsnäs  59.286405  18.704700   \n",
       "1   9021001000102000             Styrsvik  59.280184  18.731426   \n",
       "2   9021001000103000            Nämdöböte  59.208731  18.740060   \n",
       "3   9021001000104000                 Aspö  59.215843  18.753410   \n",
       "4   9021001000105000              Idöborg  59.204309  18.757769   \n",
       "5   9021001000106000             Östanvik  59.197456  18.739825   \n",
       "6   9021001000107000           Kalkberget  59.191628  18.719581   \n",
       "7   9021001000108000            Västanvik  59.187559  18.706893   \n",
       "8   9021001000109000               Solvik  59.184758  18.700458   \n",
       "9   9021001000110000                Orrön  59.180510  18.700629   \n",
       "10  9021001000111000                 Sand  59.182354  18.692684   \n",
       "11  9021001000112000              Bunkvik  59.177537  18.669835   \n",
       "12  9021001000113000           Ängsholmen  59.172723  18.655993   \n",
       "13  9021001000114000                  Uvö  59.175039  18.648745   \n",
       "14  9021001000115000           Sunnansund  59.171029  18.639195   \n",
       "15  9021001000116000                Mörtö  59.162453  18.628936   \n",
       "16  9021001000117000          Mörtö södra  59.152702  18.616282   \n",
       "17  9021001000118000                Gatan  59.294298  18.756698   \n",
       "18  9021001000119000              Långvik  59.296235  18.771798   \n",
       "19  9021001000120000  Västra Skarprunmarn  59.305445  18.814167   \n",
       "\n",
       "    location_type  parent_station platform_code  \n",
       "0               1             NaN           NaN  \n",
       "1               1             NaN           NaN  \n",
       "2               1             NaN           NaN  \n",
       "3               1             NaN           NaN  \n",
       "4               1             NaN           NaN  \n",
       "5               1             NaN           NaN  \n",
       "6               1             NaN           NaN  \n",
       "7               1             NaN           NaN  \n",
       "8               1             NaN           NaN  \n",
       "9               1             NaN           NaN  \n",
       "10              1             NaN           NaN  \n",
       "11              1             NaN           NaN  \n",
       "12              1             NaN           NaN  \n",
       "13              1             NaN           NaN  \n",
       "14              1             NaN           NaN  \n",
       "15              1             NaN           NaN  \n",
       "16              1             NaN           NaN  \n",
       "17              1             NaN           NaN  \n",
       "18              1             NaN           NaN  \n",
       "19              1             NaN           NaN  "
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "archive_bytes = io.BytesIO(request_static.content)\n",
    "\n",
    "with zipfile.ZipFile(archive_bytes, \"r\") as z:\n",
    "    with z.open(\"stops.txt\") as f:\n",
    "        df_stops = pd.read_csv(f)\n",
    "\n",
    "df_stops.head(20)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "17e86ebf",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/var/folders/xs/9pw_49kx273dmym0qk_0l_s00000gn/T/ipykernel_13388/134053024.py:1: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  df_bus[\"stop_id\"] = df_bus[\"stop_id\"].astype(\"string\")\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>entity_id</th>\n",
       "      <th>trip_id</th>\n",
       "      <th>start_date</th>\n",
       "      <th>schedule_relationship</th>\n",
       "      <th>vehicle_id</th>\n",
       "      <th>stop_sequence</th>\n",
       "      <th>stop_id</th>\n",
       "      <th>stop_arrival_delay</th>\n",
       "      <th>stop_arrival_time</th>\n",
       "      <th>stop_uncertainty</th>\n",
       "      <th>...</th>\n",
       "      <th>route_short_name</th>\n",
       "      <th>route_long_name</th>\n",
       "      <th>route_type</th>\n",
       "      <th>route_desc</th>\n",
       "      <th>stop_name</th>\n",
       "      <th>stop_lat</th>\n",
       "      <th>stop_lon</th>\n",
       "      <th>location_type</th>\n",
       "      <th>parent_station</th>\n",
       "      <th>platform_code</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>4932</th>\n",
       "      <td>14010517259199148</td>\n",
       "      <td>14010000670281887</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001003003497</td>\n",
       "      <td>4</td>\n",
       "      <td>9022001075218001</td>\n",
       "      <td>3</td>\n",
       "      <td>1766679780</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>758</td>\n",
       "      <td>NaN</td>\n",
       "      <td>700.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Mårten Bullers väg</td>\n",
       "      <td>59.191458</td>\n",
       "      <td>17.594892</td>\n",
       "      <td>0</td>\n",
       "      <td>9.021001e+15</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1743</th>\n",
       "      <td>14010517627937590</td>\n",
       "      <td>14010000708152902</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001004505588</td>\n",
       "      <td>9</td>\n",
       "      <td>9022001061060009</td>\n",
       "      <td>-113</td>\n",
       "      <td>1766681047</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>676</td>\n",
       "      <td>NaN</td>\n",
       "      <td>700.0</td>\n",
       "      <td>blåbuss</td>\n",
       "      <td>Arninge station</td>\n",
       "      <td>59.459467</td>\n",
       "      <td>18.140306</td>\n",
       "      <td>0</td>\n",
       "      <td>9.021001e+15</td>\n",
       "      <td>J</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8000</th>\n",
       "      <td>14010517190338222</td>\n",
       "      <td>14010000684641483</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001003005343</td>\n",
       "      <td>6</td>\n",
       "      <td>9022001040222002</td>\n",
       "      <td>164</td>\n",
       "      <td>1766680964</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>442</td>\n",
       "      <td>NaN</td>\n",
       "      <td>700.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Skogalundsklippan</td>\n",
       "      <td>59.313149</td>\n",
       "      <td>18.182362</td>\n",
       "      <td>0</td>\n",
       "      <td>9.021001e+15</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7141</th>\n",
       "      <td>14010517580799048</td>\n",
       "      <td>14010000709020926</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001004505190</td>\n",
       "      <td>25</td>\n",
       "      <td>9022001060080001</td>\n",
       "      <td>-268</td>\n",
       "      <td>1766682692</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>670</td>\n",
       "      <td>NaN</td>\n",
       "      <td>700.0</td>\n",
       "      <td>blåbuss</td>\n",
       "      <td>Tekniska högskolan</td>\n",
       "      <td>59.345594</td>\n",
       "      <td>18.071301</td>\n",
       "      <td>0</td>\n",
       "      <td>9.021001e+15</td>\n",
       "      <td>Z</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>200</th>\n",
       "      <td>14010517627937458</td>\n",
       "      <td>14010000708152110</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001004505587</td>\n",
       "      <td>14</td>\n",
       "      <td>9022001060301004</td>\n",
       "      <td>-82</td>\n",
       "      <td>1766680451</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>676</td>\n",
       "      <td>NaN</td>\n",
       "      <td>700.0</td>\n",
       "      <td>blåbuss</td>\n",
       "      <td>Universitetet norra</td>\n",
       "      <td>59.364977</td>\n",
       "      <td>18.053258</td>\n",
       "      <td>0</td>\n",
       "      <td>9.021001e+15</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1967</th>\n",
       "      <td>14010517627920000</td>\n",
       "      <td>14010000708152952</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001004505579</td>\n",
       "      <td>13</td>\n",
       "      <td>9022001062573001</td>\n",
       "      <td>-94</td>\n",
       "      <td>1766682430</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>676</td>\n",
       "      <td>NaN</td>\n",
       "      <td>700.0</td>\n",
       "      <td>blåbuss</td>\n",
       "      <td>Gustavslund</td>\n",
       "      <td>59.752484</td>\n",
       "      <td>18.692476</td>\n",
       "      <td>0</td>\n",
       "      <td>9.021001e+15</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4026</th>\n",
       "      <td>14010517576042366</td>\n",
       "      <td>14010000664272942</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001001007206</td>\n",
       "      <td>16</td>\n",
       "      <td>9022001010373002</td>\n",
       "      <td>130</td>\n",
       "      <td>1766680851</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>3</td>\n",
       "      <td>NaN</td>\n",
       "      <td>700.0</td>\n",
       "      <td>blåbuss</td>\n",
       "      <td>Polhemsgatan</td>\n",
       "      <td>59.330106</td>\n",
       "      <td>18.035682</td>\n",
       "      <td>0</td>\n",
       "      <td>9.021001e+15</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9448</th>\n",
       "      <td>14010517258852348</td>\n",
       "      <td>14010000509131791</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001003003592</td>\n",
       "      <td>5</td>\n",
       "      <td>9022001079735002</td>\n",
       "      <td>102</td>\n",
       "      <td>1766680615</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>752</td>\n",
       "      <td>NaN</td>\n",
       "      <td>700.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Gesällvägen</td>\n",
       "      <td>59.181225</td>\n",
       "      <td>17.589441</td>\n",
       "      <td>0</td>\n",
       "      <td>9.021001e+15</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3990</th>\n",
       "      <td>14010517279811575</td>\n",
       "      <td>14010000703340423</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001001004615</td>\n",
       "      <td>11</td>\n",
       "      <td>9022001050350001</td>\n",
       "      <td>-4</td>\n",
       "      <td>1766680189</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>515</td>\n",
       "      <td>NaN</td>\n",
       "      <td>700.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Dalvägen</td>\n",
       "      <td>59.365509</td>\n",
       "      <td>18.006350</td>\n",
       "      <td>0</td>\n",
       "      <td>9.021001e+15</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8325</th>\n",
       "      <td>14010517627970806</td>\n",
       "      <td>14010000708153554</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001004505137</td>\n",
       "      <td>10</td>\n",
       "      <td>9022001064737002</td>\n",
       "      <td>125</td>\n",
       "      <td>1766680923</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>655</td>\n",
       "      <td>NaN</td>\n",
       "      <td>700.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Sundtorpet</td>\n",
       "      <td>59.741379</td>\n",
       "      <td>18.649917</td>\n",
       "      <td>0</td>\n",
       "      <td>9.021001e+15</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7434</th>\n",
       "      <td>14010517327419732</td>\n",
       "      <td>14010000673586825</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001003005572</td>\n",
       "      <td>10</td>\n",
       "      <td>9022001013361002</td>\n",
       "      <td>-53</td>\n",
       "      <td>1766680481</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>141</td>\n",
       "      <td>NaN</td>\n",
       "      <td>700.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Johan Skytteskolan</td>\n",
       "      <td>59.277134</td>\n",
       "      <td>17.980896</td>\n",
       "      <td>0</td>\n",
       "      <td>9.021001e+15</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>311</th>\n",
       "      <td>14010517652644193</td>\n",
       "      <td>14010100711492541</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001001501720</td>\n",
       "      <td>56</td>\n",
       "      <td>9022001080383001</td>\n",
       "      <td>7</td>\n",
       "      <td>1766681149</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>819</td>\n",
       "      <td>NaN</td>\n",
       "      <td>700.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Långsjövägen</td>\n",
       "      <td>59.220921</td>\n",
       "      <td>18.215530</td>\n",
       "      <td>0</td>\n",
       "      <td>9.021001e+15</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7666</th>\n",
       "      <td>14010517280036187</td>\n",
       "      <td>14010000694587692</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001001004136</td>\n",
       "      <td>8</td>\n",
       "      <td>9022001050297001</td>\n",
       "      <td>-52</td>\n",
       "      <td>1766680577</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>506</td>\n",
       "      <td>NaN</td>\n",
       "      <td>700.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Vireberg</td>\n",
       "      <td>59.359553</td>\n",
       "      <td>17.984912</td>\n",
       "      <td>0</td>\n",
       "      <td>9.021001e+15</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1078</th>\n",
       "      <td>14010517628079682</td>\n",
       "      <td>14010000708152719</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001004505119</td>\n",
       "      <td>43</td>\n",
       "      <td>9022001063717002</td>\n",
       "      <td>30</td>\n",
       "      <td>1766680691</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>637</td>\n",
       "      <td>NaN</td>\n",
       "      <td>700.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Norrbyle norra</td>\n",
       "      <td>60.032905</td>\n",
       "      <td>18.783252</td>\n",
       "      <td>0</td>\n",
       "      <td>9.021001e+15</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9048</th>\n",
       "      <td>14010517279811661</td>\n",
       "      <td>14010000703340733</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001001004567</td>\n",
       "      <td>5</td>\n",
       "      <td>9022001010553001</td>\n",
       "      <td>132</td>\n",
       "      <td>1766680585</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>515</td>\n",
       "      <td>NaN</td>\n",
       "      <td>700.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Norrtull</td>\n",
       "      <td>59.350402</td>\n",
       "      <td>18.045438</td>\n",
       "      <td>0</td>\n",
       "      <td>9.021001e+15</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5600</th>\n",
       "      <td>14010517558090865</td>\n",
       "      <td>14010000700371054</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001003003133</td>\n",
       "      <td>7</td>\n",
       "      <td>9022001013709003</td>\n",
       "      <td>34</td>\n",
       "      <td>1766679969</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>831</td>\n",
       "      <td>NaN</td>\n",
       "      <td>700.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Edsvallabacken</td>\n",
       "      <td>59.240447</td>\n",
       "      <td>18.113039</td>\n",
       "      <td>0</td>\n",
       "      <td>9.021001e+15</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1736</th>\n",
       "      <td>14010517573037395</td>\n",
       "      <td>14010000664347747</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001001004815</td>\n",
       "      <td>26</td>\n",
       "      <td>9022001010601002</td>\n",
       "      <td>64</td>\n",
       "      <td>1766680649</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>61</td>\n",
       "      <td>NaN</td>\n",
       "      <td>700.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Körsbärsvägen</td>\n",
       "      <td>59.347949</td>\n",
       "      <td>18.065381</td>\n",
       "      <td>0</td>\n",
       "      <td>9.021001e+15</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5534</th>\n",
       "      <td>14010517627920058</td>\n",
       "      <td>14010000708153355</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001004505591</td>\n",
       "      <td>2</td>\n",
       "      <td>9022001069009001</td>\n",
       "      <td>181</td>\n",
       "      <td>1766679972</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>676</td>\n",
       "      <td>NaN</td>\n",
       "      <td>700.0</td>\n",
       "      <td>blåbuss</td>\n",
       "      <td>Albano</td>\n",
       "      <td>59.356380</td>\n",
       "      <td>18.055944</td>\n",
       "      <td>0</td>\n",
       "      <td>9.021001e+15</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1481</th>\n",
       "      <td>14010517569037279</td>\n",
       "      <td>14010000706823729</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001001004660</td>\n",
       "      <td>23</td>\n",
       "      <td>9022001012338002</td>\n",
       "      <td>269</td>\n",
       "      <td>1766680403</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>118</td>\n",
       "      <td>NaN</td>\n",
       "      <td>700.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Artillerivägen</td>\n",
       "      <td>59.378092</td>\n",
       "      <td>17.940069</td>\n",
       "      <td>0</td>\n",
       "      <td>9.021001e+15</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9331</th>\n",
       "      <td>14010517550822824</td>\n",
       "      <td>14010000700446333</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001001501704</td>\n",
       "      <td>11</td>\n",
       "      <td>9022001080013002</td>\n",
       "      <td>18</td>\n",
       "      <td>1766681195</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>875</td>\n",
       "      <td>NaN</td>\n",
       "      <td>700.0</td>\n",
       "      <td>blåbuss</td>\n",
       "      <td>Bollmoraberg</td>\n",
       "      <td>59.242808</td>\n",
       "      <td>18.224506</td>\n",
       "      <td>0</td>\n",
       "      <td>9.021001e+15</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>20 rows × 30 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "              entity_id            trip_id start_date  schedule_relationship  \\\n",
       "4932  14010517259199148  14010000670281887   20251225                      0   \n",
       "1743  14010517627937590  14010000708152902   20251225                      0   \n",
       "8000  14010517190338222  14010000684641483   20251225                      0   \n",
       "7141  14010517580799048  14010000709020926   20251225                      0   \n",
       "200   14010517627937458  14010000708152110   20251225                      0   \n",
       "1967  14010517627920000  14010000708152952   20251225                      0   \n",
       "4026  14010517576042366  14010000664272942   20251225                      0   \n",
       "9448  14010517258852348  14010000509131791   20251225                      0   \n",
       "3990  14010517279811575  14010000703340423   20251225                      0   \n",
       "8325  14010517627970806  14010000708153554   20251225                      0   \n",
       "7434  14010517327419732  14010000673586825   20251225                      0   \n",
       "311   14010517652644193  14010100711492541   20251225                      0   \n",
       "7666  14010517280036187  14010000694587692   20251225                      0   \n",
       "1078  14010517628079682  14010000708152719   20251225                      0   \n",
       "9048  14010517279811661  14010000703340733   20251225                      0   \n",
       "5600  14010517558090865  14010000700371054   20251225                      0   \n",
       "1736  14010517573037395  14010000664347747   20251225                      0   \n",
       "5534  14010517627920058  14010000708153355   20251225                      0   \n",
       "1481  14010517569037279  14010000706823729   20251225                      0   \n",
       "9331  14010517550822824  14010000700446333   20251225                      0   \n",
       "\n",
       "            vehicle_id  stop_sequence           stop_id  stop_arrival_delay  \\\n",
       "4932  9031001003003497              4  9022001075218001                   3   \n",
       "1743  9031001004505588              9  9022001061060009                -113   \n",
       "8000  9031001003005343              6  9022001040222002                 164   \n",
       "7141  9031001004505190             25  9022001060080001                -268   \n",
       "200   9031001004505587             14  9022001060301004                 -82   \n",
       "1967  9031001004505579             13  9022001062573001                 -94   \n",
       "4026  9031001001007206             16  9022001010373002                 130   \n",
       "9448  9031001003003592              5  9022001079735002                 102   \n",
       "3990  9031001001004615             11  9022001050350001                  -4   \n",
       "8325  9031001004505137             10  9022001064737002                 125   \n",
       "7434  9031001003005572             10  9022001013361002                 -53   \n",
       "311   9031001001501720             56  9022001080383001                   7   \n",
       "7666  9031001001004136              8  9022001050297001                 -52   \n",
       "1078  9031001004505119             43  9022001063717002                  30   \n",
       "9048  9031001001004567              5  9022001010553001                 132   \n",
       "5600  9031001003003133              7  9022001013709003                  34   \n",
       "1736  9031001001004815             26  9022001010601002                  64   \n",
       "5534  9031001004505591              2  9022001069009001                 181   \n",
       "1481  9031001001004660             23  9022001012338002                 269   \n",
       "9331  9031001001501704             11  9022001080013002                  18   \n",
       "\n",
       "      stop_arrival_time  stop_uncertainty  ...  route_short_name  \\\n",
       "4932         1766679780                 0  ...               758   \n",
       "1743         1766681047                 0  ...               676   \n",
       "8000         1766680964                 0  ...               442   \n",
       "7141         1766682692                 0  ...               670   \n",
       "200          1766680451                 0  ...               676   \n",
       "1967         1766682430                 0  ...               676   \n",
       "4026         1766680851                 0  ...                 3   \n",
       "9448         1766680615                 0  ...               752   \n",
       "3990         1766680189                 0  ...               515   \n",
       "8325         1766680923                 0  ...               655   \n",
       "7434         1766680481                 0  ...               141   \n",
       "311          1766681149                 0  ...               819   \n",
       "7666         1766680577                 0  ...               506   \n",
       "1078         1766680691                 0  ...               637   \n",
       "9048         1766680585                 0  ...               515   \n",
       "5600         1766679969                 0  ...               831   \n",
       "1736         1766680649                 0  ...                61   \n",
       "5534         1766679972                 0  ...               676   \n",
       "1481         1766680403                 0  ...               118   \n",
       "9331         1766681195                 0  ...               875   \n",
       "\n",
       "      route_long_name  route_type  route_desc            stop_name   stop_lat  \\\n",
       "4932              NaN       700.0         NaN   Mårten Bullers väg  59.191458   \n",
       "1743              NaN       700.0     blåbuss      Arninge station  59.459467   \n",
       "8000              NaN       700.0         NaN    Skogalundsklippan  59.313149   \n",
       "7141              NaN       700.0     blåbuss   Tekniska högskolan  59.345594   \n",
       "200               NaN       700.0     blåbuss  Universitetet norra  59.364977   \n",
       "1967              NaN       700.0     blåbuss          Gustavslund  59.752484   \n",
       "4026              NaN       700.0     blåbuss         Polhemsgatan  59.330106   \n",
       "9448              NaN       700.0         NaN          Gesällvägen  59.181225   \n",
       "3990              NaN       700.0         NaN             Dalvägen  59.365509   \n",
       "8325              NaN       700.0         NaN           Sundtorpet  59.741379   \n",
       "7434              NaN       700.0         NaN   Johan Skytteskolan  59.277134   \n",
       "311               NaN       700.0         NaN         Långsjövägen  59.220921   \n",
       "7666              NaN       700.0         NaN             Vireberg  59.359553   \n",
       "1078              NaN       700.0         NaN       Norrbyle norra  60.032905   \n",
       "9048              NaN       700.0         NaN             Norrtull  59.350402   \n",
       "5600              NaN       700.0         NaN       Edsvallabacken  59.240447   \n",
       "1736              NaN       700.0         NaN        Körsbärsvägen  59.347949   \n",
       "5534              NaN       700.0     blåbuss               Albano  59.356380   \n",
       "1481              NaN       700.0         NaN       Artillerivägen  59.378092   \n",
       "9331              NaN       700.0     blåbuss         Bollmoraberg  59.242808   \n",
       "\n",
       "       stop_lon  location_type  parent_station  platform_code  \n",
       "4932  17.594892              0    9.021001e+15            NaN  \n",
       "1743  18.140306              0    9.021001e+15              J  \n",
       "8000  18.182362              0    9.021001e+15            NaN  \n",
       "7141  18.071301              0    9.021001e+15              Z  \n",
       "200   18.053258              0    9.021001e+15            NaN  \n",
       "1967  18.692476              0    9.021001e+15            NaN  \n",
       "4026  18.035682              0    9.021001e+15            NaN  \n",
       "9448  17.589441              0    9.021001e+15              2  \n",
       "3990  18.006350              0    9.021001e+15            NaN  \n",
       "8325  18.649917              0    9.021001e+15            NaN  \n",
       "7434  17.980896              0    9.021001e+15            NaN  \n",
       "311   18.215530              0    9.021001e+15            NaN  \n",
       "7666  17.984912              0    9.021001e+15            NaN  \n",
       "1078  18.783252              0    9.021001e+15            NaN  \n",
       "9048  18.045438              0    9.021001e+15            NaN  \n",
       "5600  18.113039              0    9.021001e+15            NaN  \n",
       "1736  18.065381              0    9.021001e+15            NaN  \n",
       "5534  18.055944              0    9.021001e+15            NaN  \n",
       "1481  17.940069              0    9.021001e+15            NaN  \n",
       "9331  18.224506              0    9.021001e+15            NaN  \n",
       "\n",
       "[20 rows x 30 columns]"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_bus[\"stop_id\"] = df_bus[\"stop_id\"].astype(\"string\")\n",
    "df_stops[\"stop_id\"] = df_stops[\"stop_id\"].astype(\"string\")\n",
    "\n",
    "df_global = df_bus.merge(df_stops, on=\"stop_id\", how=\"left\")\n",
    "df_global.sample(20)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "9c0fb267",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>entity_id</th>\n",
       "      <th>trip_id</th>\n",
       "      <th>start_date</th>\n",
       "      <th>schedule_relationship</th>\n",
       "      <th>vehicle_id</th>\n",
       "      <th>stop_sequence</th>\n",
       "      <th>stop_id</th>\n",
       "      <th>stop_arrival_delay</th>\n",
       "      <th>stop_arrival_time</th>\n",
       "      <th>stop_uncertainty</th>\n",
       "      <th>...</th>\n",
       "      <th>timestamp</th>\n",
       "      <th>route_id</th>\n",
       "      <th>service_id</th>\n",
       "      <th>trip_headsign</th>\n",
       "      <th>direction_id</th>\n",
       "      <th>shape_id</th>\n",
       "      <th>agency_id</th>\n",
       "      <th>route_short_name</th>\n",
       "      <th>stop_lat</th>\n",
       "      <th>stop_lon</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>14010517605467215</td>\n",
       "      <td>14010000684979940</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001003005316</td>\n",
       "      <td>12</td>\n",
       "      <td>9022001040243002</td>\n",
       "      <td>7992</td>\n",
       "      <td>1766680325</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>1766680146</td>\n",
       "      <td>9011001044400000</td>\n",
       "      <td>552.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.014010e+18</td>\n",
       "      <td>1.401000e+16</td>\n",
       "      <td>444</td>\n",
       "      <td>59.312199</td>\n",
       "      <td>18.164664</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>14010517605467215</td>\n",
       "      <td>14010000684979940</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001003005316</td>\n",
       "      <td>13</td>\n",
       "      <td>9022001010595002</td>\n",
       "      <td>7892</td>\n",
       "      <td>1766680566</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>1766680146</td>\n",
       "      <td>9011001044400000</td>\n",
       "      <td>552.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.014010e+18</td>\n",
       "      <td>1.401000e+16</td>\n",
       "      <td>444</td>\n",
       "      <td>59.312256</td>\n",
       "      <td>18.107849</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>14010517605467215</td>\n",
       "      <td>14010000684979940</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001003005316</td>\n",
       "      <td>14</td>\n",
       "      <td>9022001010591002</td>\n",
       "      <td>7915</td>\n",
       "      <td>1766680645</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>1766680146</td>\n",
       "      <td>9011001044400000</td>\n",
       "      <td>552.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.014010e+18</td>\n",
       "      <td>1.401000e+16</td>\n",
       "      <td>444</td>\n",
       "      <td>59.314853</td>\n",
       "      <td>18.097128</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>14010517605467215</td>\n",
       "      <td>14010000684979940</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001003005316</td>\n",
       "      <td>15</td>\n",
       "      <td>9022001044000019</td>\n",
       "      <td>7811</td>\n",
       "      <td>1766680811</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>1766680146</td>\n",
       "      <td>9011001044400000</td>\n",
       "      <td>552.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.014010e+18</td>\n",
       "      <td>1.401000e+16</td>\n",
       "      <td>444</td>\n",
       "      <td>59.319100</td>\n",
       "      <td>18.078440</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>14010517558156042</td>\n",
       "      <td>14010000708187798</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001003003060</td>\n",
       "      <td>61</td>\n",
       "      <td>9022001075505001</td>\n",
       "      <td>-16</td>\n",
       "      <td>1766679740</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>1766680367</td>\n",
       "      <td>9011001078300000</td>\n",
       "      <td>50.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.014010e+18</td>\n",
       "      <td>1.401000e+16</td>\n",
       "      <td>783</td>\n",
       "      <td>58.940050</td>\n",
       "      <td>17.913335</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11284</th>\n",
       "      <td>14010517578035273</td>\n",
       "      <td>14010100702300966</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001001004046</td>\n",
       "      <td>11</td>\n",
       "      <td>9022001020051002</td>\n",
       "      <td>6</td>\n",
       "      <td>1766681492</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>1766680299</td>\n",
       "      <td>9011001020100000</td>\n",
       "      <td>272.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.014010e+18</td>\n",
       "      <td>1.401000e+16</td>\n",
       "      <td>201</td>\n",
       "      <td>59.365077</td>\n",
       "      <td>18.139401</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11285</th>\n",
       "      <td>14010517578035273</td>\n",
       "      <td>14010100702300966</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001001004046</td>\n",
       "      <td>12</td>\n",
       "      <td>9022001020041002</td>\n",
       "      <td>-4</td>\n",
       "      <td>1766681576</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>1766680299</td>\n",
       "      <td>9011001020100000</td>\n",
       "      <td>272.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.014010e+18</td>\n",
       "      <td>1.401000e+16</td>\n",
       "      <td>201</td>\n",
       "      <td>59.365040</td>\n",
       "      <td>18.133224</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11286</th>\n",
       "      <td>14010517578035273</td>\n",
       "      <td>14010100702300966</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001001004046</td>\n",
       "      <td>13</td>\n",
       "      <td>9022001020031002</td>\n",
       "      <td>14</td>\n",
       "      <td>1766681630</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>1766680299</td>\n",
       "      <td>9011001020100000</td>\n",
       "      <td>272.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.014010e+18</td>\n",
       "      <td>1.401000e+16</td>\n",
       "      <td>201</td>\n",
       "      <td>59.364973</td>\n",
       "      <td>18.129696</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11287</th>\n",
       "      <td>14010517578035273</td>\n",
       "      <td>14010100702300966</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001001004046</td>\n",
       "      <td>14</td>\n",
       "      <td>9022001020021002</td>\n",
       "      <td>4</td>\n",
       "      <td>1766681690</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>1766680299</td>\n",
       "      <td>9011001020100000</td>\n",
       "      <td>272.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.014010e+18</td>\n",
       "      <td>1.401000e+16</td>\n",
       "      <td>201</td>\n",
       "      <td>59.363907</td>\n",
       "      <td>18.123552</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11288</th>\n",
       "      <td>14010517578035273</td>\n",
       "      <td>14010100702300966</td>\n",
       "      <td>20251225</td>\n",
       "      <td>0</td>\n",
       "      <td>9031001001004046</td>\n",
       "      <td>15</td>\n",
       "      <td>9022001010032014</td>\n",
       "      <td>-163</td>\n",
       "      <td>1766681837</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>1766680299</td>\n",
       "      <td>9011001020100000</td>\n",
       "      <td>272.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.014010e+18</td>\n",
       "      <td>1.401000e+16</td>\n",
       "      <td>201</td>\n",
       "      <td>59.357413</td>\n",
       "      <td>18.101837</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>11289 rows × 23 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "               entity_id            trip_id start_date  schedule_relationship  \\\n",
       "0      14010517605467215  14010000684979940   20251225                      0   \n",
       "1      14010517605467215  14010000684979940   20251225                      0   \n",
       "2      14010517605467215  14010000684979940   20251225                      0   \n",
       "3      14010517605467215  14010000684979940   20251225                      0   \n",
       "4      14010517558156042  14010000708187798   20251225                      0   \n",
       "...                  ...                ...        ...                    ...   \n",
       "11284  14010517578035273  14010100702300966   20251225                      0   \n",
       "11285  14010517578035273  14010100702300966   20251225                      0   \n",
       "11286  14010517578035273  14010100702300966   20251225                      0   \n",
       "11287  14010517578035273  14010100702300966   20251225                      0   \n",
       "11288  14010517578035273  14010100702300966   20251225                      0   \n",
       "\n",
       "             vehicle_id  stop_sequence           stop_id  stop_arrival_delay  \\\n",
       "0      9031001003005316             12  9022001040243002                7992   \n",
       "1      9031001003005316             13  9022001010595002                7892   \n",
       "2      9031001003005316             14  9022001010591002                7915   \n",
       "3      9031001003005316             15  9022001044000019                7811   \n",
       "4      9031001003003060             61  9022001075505001                 -16   \n",
       "...                 ...            ...               ...                 ...   \n",
       "11284  9031001001004046             11  9022001020051002                   6   \n",
       "11285  9031001001004046             12  9022001020041002                  -4   \n",
       "11286  9031001001004046             13  9022001020031002                  14   \n",
       "11287  9031001001004046             14  9022001020021002                   4   \n",
       "11288  9031001001004046             15  9022001010032014                -163   \n",
       "\n",
       "       stop_arrival_time  stop_uncertainty  ...   timestamp          route_id  \\\n",
       "0             1766680325                 0  ...  1766680146  9011001044400000   \n",
       "1             1766680566                 0  ...  1766680146  9011001044400000   \n",
       "2             1766680645                 0  ...  1766680146  9011001044400000   \n",
       "3             1766680811                 0  ...  1766680146  9011001044400000   \n",
       "4             1766679740                 0  ...  1766680367  9011001078300000   \n",
       "...                  ...               ...  ...         ...               ...   \n",
       "11284         1766681492                 0  ...  1766680299  9011001020100000   \n",
       "11285         1766681576                 0  ...  1766680299  9011001020100000   \n",
       "11286         1766681630                 0  ...  1766680299  9011001020100000   \n",
       "11287         1766681690                 0  ...  1766680299  9011001020100000   \n",
       "11288         1766681837                 0  ...  1766680299  9011001020100000   \n",
       "\n",
       "       service_id  trip_headsign direction_id      shape_id     agency_id  \\\n",
       "0           552.0            NaN          0.0  1.014010e+18  1.401000e+16   \n",
       "1           552.0            NaN          0.0  1.014010e+18  1.401000e+16   \n",
       "2           552.0            NaN          0.0  1.014010e+18  1.401000e+16   \n",
       "3           552.0            NaN          0.0  1.014010e+18  1.401000e+16   \n",
       "4            50.0            NaN          1.0  1.014010e+18  1.401000e+16   \n",
       "...           ...            ...          ...           ...           ...   \n",
       "11284       272.0            NaN          0.0  1.014010e+18  1.401000e+16   \n",
       "11285       272.0            NaN          0.0  1.014010e+18  1.401000e+16   \n",
       "11286       272.0            NaN          0.0  1.014010e+18  1.401000e+16   \n",
       "11287       272.0            NaN          0.0  1.014010e+18  1.401000e+16   \n",
       "11288       272.0            NaN          0.0  1.014010e+18  1.401000e+16   \n",
       "\n",
       "       route_short_name   stop_lat   stop_lon  \n",
       "0                   444  59.312199  18.164664  \n",
       "1                   444  59.312256  18.107849  \n",
       "2                   444  59.314853  18.097128  \n",
       "3                   444  59.319100  18.078440  \n",
       "4                   783  58.940050  17.913335  \n",
       "...                 ...        ...        ...  \n",
       "11284               201  59.365077  18.139401  \n",
       "11285               201  59.365040  18.133224  \n",
       "11286               201  59.364973  18.129696  \n",
       "11287               201  59.363907  18.123552  \n",
       "11288               201  59.357413  18.101837  \n",
       "\n",
       "[11289 rows x 23 columns]"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_final = df_global.drop(columns=[\"route_type\", \"route_desc\", \"stop_name\", \"location_type\", \"route_long_name\", \"parent_station\", \"platform_code\"])\n",
    "df_final"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "dbb0add3",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "['444' '783' '677' '865' '636' '645' '579' '176' '172' '626' '707' '708'\n",
      " '676' '555' '840' '177' '541' '422' '848' '161' '819' '173' '163' '434'\n",
      " '540' '179' '514X' '639' '26M' '702' '178' '758' '4' '552H' '57' '564H'\n",
      " '835' '727' '641' '474' '780X' '3' '777' '740' '440' '1' '66' '742' '74'\n",
      " '839' '787' '751' '710' '753' '713' '428X' '25M' '637' '610' '601' '524'\n",
      " '430X' '552V' '621' '824' '830' '118' '76' '517' '165' '144' '509' '807'\n",
      " '471' '61' '849' '744' '546H' '113' '119' '705' '55' '831' '506' '670'\n",
      " '53' '567' '67' '238' '2' '519' '607' '627' '564V' '553V' '832' '544'\n",
      " '558' '409' '542' '340' '873' '559' '875' '816' '858' '754' '414' '433'\n",
      " '504' '438' '632' '520' '652' '515' '833' '129' '709' '788' '181' '629'\n",
      " '605' '65' '837' '135' '802' '801' '401' '6' '615' '611' '160' '756'\n",
      " '533' '660' '465' '50' '410' '180' '117' '175' '309' '134' '560' '580'\n",
      " '852' '845' '112' '550' '204' '665' '402' '562' '714' '508' '350' '437'\n",
      " '684' '664' '5' '188' '616' '523' '443' '553H' '704' '114' '69' '71T'\n",
      " '659' '54' '536' '505' '854' '606' '56' '142' '164' '604' '602' '143'\n",
      " '688' '829' '185V' '206' '205' '201' '568' '575' '612' '631X' '141' '838'\n",
      " '582' '417' '750' '512' '442' '525' '584' '634' '655' '547' '759' '844'\n",
      " '721X' '302' '421' '531' '124' '501' '821' '570' '748' '147' '184' '683'\n",
      " '545' '529' '718' '752' '623V' '723' '834' '847' '548' '116' '583' '738'\n",
      " '658' '534' '715V' '317' '526' '846' '682' '719' '622' '716' '778' '617'\n",
      " '458' '127' '503' '461' '657' '633']\n"
     ]
    }
   ],
   "source": [
    "bus_numbers = df_final[\"route_short_name\"].unique()\n",
    "print(bus_numbers)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c0dc0d33",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e70f9771",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b8759170",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "base",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
